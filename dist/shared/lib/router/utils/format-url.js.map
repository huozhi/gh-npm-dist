{"version":3,"sources":["../../../../../shared/lib/router/utils/format-url.ts"],"sourcesContent":["// Format function modified from nodejs\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nimport { UrlObject } from 'url'\nimport { ParsedUrlQuery } from 'querystring'\nimport * as querystring from './querystring'\n\nconst slashedProtocols = /https?|ftp|gopher|file/\n\nexport function formatUrl(urlObj: UrlObject) {\n  let { auth, hostname } = urlObj\n  let protocol = urlObj.protocol || ''\n  let pathname = urlObj.pathname || ''\n  let hash = urlObj.hash || ''\n  let query = urlObj.query || ''\n  let host: string | false = false\n\n  auth = auth ? encodeURIComponent(auth).replace(/%3A/i, ':') + '@' : ''\n\n  if (urlObj.host) {\n    host = auth + urlObj.host\n  } else if (hostname) {\n    host = auth + (~hostname.indexOf(':') ? `[${hostname}]` : hostname)\n    if (urlObj.port) {\n      host += ':' + urlObj.port\n    }\n  }\n\n  if (query && typeof query === 'object') {\n    query = String(querystring.urlQueryToSearchParams(query as ParsedUrlQuery))\n  }\n\n  let search = urlObj.search || (query && `?${query}`) || ''\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':'\n\n  if (\n    urlObj.slashes ||\n    ((!protocol || slashedProtocols.test(protocol)) && host !== false)\n  ) {\n    host = '//' + (host || '')\n    if (pathname && pathname[0] !== '/') pathname = '/' + pathname\n  } else if (!host) {\n    host = ''\n  }\n\n  if (hash && hash[0] !== '#') hash = '#' + hash\n  if (search && search[0] !== '?') search = '?' + search\n\n  pathname = pathname.replace(/[?#]/g, encodeURIComponent)\n  search = search.replace('#', '%23')\n\n  return `${protocol}${host}${pathname}${search}${hash}`\n}\n"],"names":["formatUrl","querystring","slashedProtocols","urlObj","auth","hostname","protocol","pathname","hash","query","host","encodeURIComponent","replace","indexOf","port","String","urlQueryToSearchParams","search","substr","slashes","test"],"mappings":";;;;QA4BgBA,SAAS,GAATA,SAAS;AAJbC,GAAW,CAAXA,WAAW;;;;;;;;;;;;;;;;;;;;;;AAEvB,KAAK,CAACC,gBAAgB;SAENF,SAAS,CAACG,MAAiB,EAAE,CAAC;IAC5C,GAAG,CAAC,CAAC,CAACC,IAAI,GAAEC,QAAQ,EAAC,CAAC,GAAGF,MAAM;IAC/B,GAAG,CAACG,QAAQ,GAAGH,MAAM,CAACG,QAAQ,IAAI,CAAE;IACpC,GAAG,CAACC,QAAQ,GAAGJ,MAAM,CAACI,QAAQ,IAAI,CAAE;IACpC,GAAG,CAACC,IAAI,GAAGL,MAAM,CAACK,IAAI,IAAI,CAAE;IAC5B,GAAG,CAACC,KAAK,GAAGN,MAAM,CAACM,KAAK,IAAI,CAAE;IAC9B,GAAG,CAACC,IAAI,GAAmB,KAAK;IAEhCN,IAAI,GAAGA,IAAI,GAAGO,kBAAkB,CAACP,IAAI,EAAEQ,OAAO,SAAS,CAAG,MAAI,CAAG,KAAG,CAAE;IAEtE,EAAE,EAAET,MAAM,CAACO,IAAI,EAAE,CAAC;QAChBA,IAAI,GAAGN,IAAI,GAAGD,MAAM,CAACO,IAAI;IAC3B,CAAC,MAAM,EAAE,EAAEL,QAAQ,EAAE,CAAC;QACpBK,IAAI,GAAGN,IAAI,KAAKC,QAAQ,CAACQ,OAAO,CAAC,CAAG,OAAK,CAAC,EAAER,QAAQ,CAAC,CAAC,IAAIA,QAAQ;QAClE,EAAE,EAAEF,MAAM,CAACW,IAAI,EAAE,CAAC;YAChBJ,IAAI,IAAI,CAAG,KAAGP,MAAM,CAACW,IAAI;QAC3B,CAAC;IACH,CAAC;IAED,EAAE,EAAEL,KAAK,IAAI,MAAM,CAACA,KAAK,KAAK,CAAQ,SAAE,CAAC;QACvCA,KAAK,GAAGM,MAAM,CAxBNd,WAAW,CAwBQe,sBAAsB,CAACP,KAAK;IACzD,CAAC;IAED,GAAG,CAACQ,MAAM,GAAGd,MAAM,CAACc,MAAM,IAAKR,KAAK,KAAK,CAAC,EAAEA,KAAK,MAAO,CAAE;IAE1D,EAAE,EAAEH,QAAQ,IAAIA,QAAQ,CAACY,MAAM,EAAE,CAAC,MAAM,CAAG,IAAEZ,QAAQ,IAAI,CAAG;IAE5D,EAAE,EACAH,MAAM,CAACgB,OAAO,MACXb,QAAQ,IAAIJ,gBAAgB,CAACkB,IAAI,CAACd,QAAQ,MAAMI,IAAI,KAAK,KAAK,EACjE,CAAC;QACDA,IAAI,GAAG,CAAI,OAAIA,IAAI,IAAI,CAAE;QACzB,EAAE,EAAEH,QAAQ,IAAIA,QAAQ,CAAC,CAAC,MAAM,CAAG,IAAEA,QAAQ,GAAG,CAAG,KAAGA,QAAQ;IAChE,CAAC,MAAM,EAAE,GAAGG,IAAI,EAAE,CAAC;QACjBA,IAAI,GAAG,CAAE;IACX,CAAC;IAED,EAAE,EAAEF,IAAI,IAAIA,IAAI,CAAC,CAAC,MAAM,CAAG,IAAEA,IAAI,GAAG,CAAG,KAAGA,IAAI;IAC9C,EAAE,EAAES,MAAM,IAAIA,MAAM,CAAC,CAAC,MAAM,CAAG,IAAEA,MAAM,GAAG,CAAG,KAAGA,MAAM;IAEtDV,QAAQ,GAAGA,QAAQ,CAACK,OAAO,UAAUD,kBAAkB;IACvDM,MAAM,GAAGA,MAAM,CAACL,OAAO,CAAC,CAAG,IAAE,CAAK;IAElC,MAAM,IAAIN,QAAQ,GAAGI,IAAI,GAAGH,QAAQ,GAAGU,MAAM,GAAGT,IAAI;AACtD,CAAC"}