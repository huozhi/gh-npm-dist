{"version":3,"sources":["../../telemetry/anonymous-meta.ts"],"sourcesContent":["import isDockerFunction from 'next/dist/compiled/is-docker'\nimport isWslBoolean from 'next/dist/compiled/is-wsl'\nimport os from 'os'\n\nimport * as ciEnvironment from './ci-info'\n\ntype AnonymousMeta = {\n  systemPlatform: NodeJS.Platform\n  systemRelease: string\n  systemArchitecture: string\n  cpuCount: number\n  cpuModel: string | null\n  cpuSpeed: number | null\n  memoryInMb: number\n  isDocker: boolean\n  isNowDev: boolean\n  isWsl: boolean\n  isCI: boolean\n  ciName: string | null\n  nextVersion: string\n}\n\nlet traits: AnonymousMeta | undefined\n\nexport function getAnonymousMeta(): AnonymousMeta {\n  if (traits) {\n    return traits\n  }\n\n  const cpus = os.cpus() || []\n  const { NOW_REGION } = process.env\n  traits = {\n    // Software information\n    systemPlatform: os.platform(),\n    systemRelease: os.release(),\n    systemArchitecture: os.arch(),\n    // Machine information\n    cpuCount: cpus.length,\n    cpuModel: cpus.length ? cpus[0].model : null,\n    cpuSpeed: cpus.length ? cpus[0].speed : null,\n    memoryInMb: Math.trunc(os.totalmem() / Math.pow(1024, 2)),\n    // Environment information\n    isDocker: isDockerFunction(),\n    isNowDev: NOW_REGION === 'dev1',\n    isWsl: isWslBoolean,\n    isCI: ciEnvironment.isCI,\n    ciName: (ciEnvironment.isCI && ciEnvironment.name) || null,\n    nextVersion: process.env.__NEXT_VERSION as string,\n  }\n\n  return traits\n}\n"],"names":["getAnonymousMeta","ciEnvironment","traits","cpus","NOW_REGION","process","env","systemPlatform","platform","systemRelease","release","systemArchitecture","arch","cpuCount","length","cpuModel","model","cpuSpeed","speed","memoryInMb","Math","trunc","totalmem","pow","isDocker","isNowDev","isWsl","isCI","ciName","name","nextVersion","__NEXT_VERSION"],"mappings":";;;;QAwBgBA,gBAAgB,GAAhBA,gBAAgB;AAxBH,GAA8B,CAA9B,SAA8B;AAClC,GAA2B,CAA3B,MAA2B;AACrC,GAAI,CAAJ,GAAI;AAEPC,GAAa,CAAbA,aAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkBzB,GAAG,CAACC,MAAM;SAEMF,gBAAgB,GAAkB,CAAC;IACjD,EAAE,EAAEE,MAAM,EAAE,CAAC;QACX,MAAM,CAACA,MAAM;IACf,CAAC;IAED,KAAK,CAACC,IAAI,GA3BG,GAAI,SA2BDA,IAAI,MAAM,CAAC,CAAC;IAC5B,KAAK,CAAC,CAAC,CAACC,UAAU,EAAC,CAAC,GAAGC,OAAO,CAACC,GAAG;IAClCJ,MAAM,GAAG,CAAC;QACR,EAAuB,AAAvB,qBAAuB;QACvBK,cAAc,EA/BH,GAAI,SA+BIC,QAAQ;QAC3BC,aAAa,EAhCF,GAAI,SAgCGC,OAAO;QACzBC,kBAAkB,EAjCP,GAAI,SAiCQC,IAAI;QAC3B,EAAsB,AAAtB,oBAAsB;QACtBC,QAAQ,EAAEV,IAAI,CAACW,MAAM;QACrBC,QAAQ,EAAEZ,IAAI,CAACW,MAAM,GAAGX,IAAI,CAAC,CAAC,EAAEa,KAAK,GAAG,IAAI;QAC5CC,QAAQ,EAAEd,IAAI,CAACW,MAAM,GAAGX,IAAI,CAAC,CAAC,EAAEe,KAAK,GAAG,IAAI;QAC5CC,UAAU,EAAEC,IAAI,CAACC,KAAK,CAtCX,GAAI,SAsCWC,QAAQ,KAAKF,IAAI,CAACG,GAAG,CAAC,IAAI,EAAE,CAAC;QACvD,EAA0B,AAA1B,wBAA0B;QAC1BC,QAAQ,MA1CiB,SAA8B;QA2CvDC,QAAQ,EAAErB,UAAU,KAAK,CAAM;QAC/BsB,KAAK,EA3CgB,MAA2B;QA4ChDC,IAAI,EAzCI1B,aAAa,CAyCD0B,IAAI;QACxBC,MAAM,EA1CE3B,aAAa,CA0CE0B,IAAI,IA1CnB1B,aAAa,CA0CwB4B,IAAI,IAAK,IAAI;QAC1DC,WAAW,EAAEzB,OAAO,CAACC,GAAG,CAACyB,cAAc;IACzC,CAAC;IAED,MAAM,CAAC7B,MAAM;AACf,CAAC"}