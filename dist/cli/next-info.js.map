{"version":3,"sources":["../../cli/next-info.ts"],"sourcesContent":["#!/usr/bin/env node\nimport os from 'os'\nimport childProcess from 'child_process'\n\nimport chalk from 'next/dist/compiled/chalk'\nimport arg from 'next/dist/compiled/arg/index.js'\nimport { printAndExit } from '../server/lib/utils'\nimport { cliCommand } from '../bin/next'\nimport isError from '../lib/is-error'\n\nconst nextInfo: cliCommand = async (argv) => {\n  const validArgs: arg.Spec = {\n    // Types\n    '--help': Boolean,\n    // Aliases\n    '-h': '--help',\n  }\n  let args: arg.Result<arg.Spec>\n  try {\n    args = arg(validArgs, { argv })\n  } catch (error) {\n    if (isError(error) && error.code === 'ARG_UNKNOWN_OPTION') {\n      return printAndExit(error.message, 1)\n    }\n    throw error\n  }\n\n  if (args['--help']) {\n    console.log(\n      `\n      Description\n        Prints relevant details about the current system which can be used to report Next.js bugs\n        \n      Usage\n        $ next info\n\n      Learn more: ${chalk.cyan(\n        'https://nextjs.org/docs/api-reference/cli#info'\n      )}`\n    )\n    return\n  }\n\n  console.log(`\n    Operating System:\n      Platform: ${os.platform()}\n      Arch: ${os.arch()}\n      Version: ${os.version()}\n    Binaries:\n      Node: ${process.versions.node}\n      npm: ${getBinaryVersion('npm')}\n      Yarn: ${getBinaryVersion('yarn')}\n      pnpm: ${getBinaryVersion('pnpm')}\n    Relevant packages:\n      next: ${getPackageVersion('next')}\n      react: ${getPackageVersion('react')}\n      react-dom: ${getPackageVersion('react-dom')}`)\n}\n\nexport { nextInfo }\n\nfunction getPackageVersion(packageName: string) {\n  try {\n    return require(`${packageName}/package.json`).version\n  } catch {\n    return 'N/A'\n  }\n}\n\nfunction getBinaryVersion(binaryName: string) {\n  try {\n    return childProcess.execSync(`${binaryName} --version`).toString().trim()\n  } catch {\n    return 'N/A'\n  }\n}\n"],"names":["nextInfo","argv","validArgs","Boolean","args","error","code","message","console","log","cyan","platform","arch","version","process","versions","node","getBinaryVersion","getPackageVersion","packageName","require","binaryName","execSync","toString","trim"],"mappings":";;;;;;AACe,GAAI,CAAJ,GAAI;AACM,GAAe,CAAf,aAAe;AAEtB,GAA0B,CAA1B,MAA0B;AAC5B,GAAiC,CAAjC,QAAiC;AACpB,GAAqB,CAArB,MAAqB;AAE9B,GAAiB,CAAjB,QAAiB;;;;;;AAErC,KAAK,CAACA,QAAQ,UAAsBC,IAAI,GAAK,CAAC;IAC5C,KAAK,CAACC,SAAS,GAAa,CAAC;QAC3B,EAAQ,AAAR,MAAQ;QACR,CAAQ,SAAEC,OAAO;QACjB,EAAU,AAAV,QAAU;QACV,CAAI,KAAE,CAAQ;IAChB,CAAC;IACD,GAAG,CAACC,IAAI;IACR,GAAG,CAAC,CAAC;QACHA,IAAI,OAdQ,QAAiC,UAclCF,SAAS,EAAE,CAAC;YAACD,IAAI;QAAC,CAAC;IAChC,CAAC,CAAC,KAAK,EAAEI,KAAK,EAAE,CAAC;QACf,EAAE,MAbc,QAAiB,UAarBA,KAAK,KAAKA,KAAK,CAACC,IAAI,KAAK,CAAoB,qBAAE,CAAC;YAC1D,MAAM,KAhBiB,MAAqB,eAgBxBD,KAAK,CAACE,OAAO,EAAE,CAAC;QACtC,CAAC;QACD,KAAK,CAACF,KAAK;IACb,CAAC;IAED,EAAE,EAAED,IAAI,CAAC,CAAQ,UAAG,CAAC;QACnBI,OAAO,CAACC,GAAG,EACR;;;;;;;kBAOW,EAhCA,MAA0B,SAgClBC,IAAI,CACtB,CAAgD;QAGpD,MAAM;IACR,CAAC;IAEDF,OAAO,CAACC,GAAG,EAAE;;gBAEC,EA5CD,GAAI,SA4CEE,QAAQ,GAAG;YACpB,EA7CG,GAAI,SA6CFC,IAAI,GAAG;eACT,EA9CA,GAAI,SA8CCC,OAAO,GAAG;;YAElB,EAAEC,OAAO,CAACC,QAAQ,CAACC,IAAI,CAAC;WACzB,EAAEC,gBAAgB,CAAC,CAAK,MAAE;YACzB,EAAEA,gBAAgB,CAAC,CAAM,OAAE;YAC3B,EAAEA,gBAAgB,CAAC,CAAM,OAAE;;YAE3B,EAAEC,iBAAiB,CAAC,CAAM,OAAE;aAC3B,EAAEA,iBAAiB,CAAC,CAAO,QAAE;iBACzB,EAAEA,iBAAiB,CAAC,CAAW;AAChD,CAAC;QAEQlB,QAAQ,GAARA,QAAQ;SAERkB,iBAAiB,CAACC,WAAmB,EAAE,CAAC;IAC/C,GAAG,CAAC,CAAC;QACH,MAAM,CAACC,OAAO,IAAID,WAAW,CAAC,aAAa,GAAGN,OAAO;IACvD,CAAC,CAAC,KAAK,EAAC,CAAC;QACP,MAAM,CAAC,CAAK;IACd,CAAC;AACH,CAAC;SAEQI,gBAAgB,CAACI,UAAkB,EAAE,CAAC;IAC7C,GAAG,CAAC,CAAC;QACH,MAAM,CArEe,aAAe,SAqEhBC,QAAQ,IAAID,UAAU,CAAC,UAAU,GAAGE,QAAQ,GAAGC,IAAI;IACzE,CAAC,CAAC,KAAK,EAAC,CAAC;QACP,MAAM,CAAC,CAAK;IACd,CAAC;AACH,CAAC"}