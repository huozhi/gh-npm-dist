{"version":3,"sources":["../../../lib/helpers/get-online.ts"],"sourcesContent":["import { execSync } from 'child_process'\nimport dns from 'dns'\nimport url from 'url'\n\nfunction getProxy(): string | undefined {\n  if (process.env.https_proxy) {\n    return process.env.https_proxy\n  }\n\n  try {\n    const httpsProxy = execSync('npm config get https-proxy').toString().trim()\n    return httpsProxy !== 'null' ? httpsProxy : undefined\n  } catch (e) {\n    return\n  }\n}\n\nexport function getOnline(): Promise<boolean> {\n  return new Promise((resolve) => {\n    dns.lookup('registry.yarnpkg.com', (registryErr) => {\n      if (!registryErr) {\n        return resolve(true)\n      }\n\n      const proxy = getProxy()\n      if (!proxy) {\n        return resolve(false)\n      }\n\n      const { hostname } = url.parse(proxy)\n      if (!hostname) {\n        return resolve(false)\n      }\n\n      dns.lookup(hostname, (proxyErr) => {\n        resolve(proxyErr == null)\n      })\n    })\n  })\n}\n"],"names":["getOnline","getProxy","process","env","https_proxy","httpsProxy","toString","trim","undefined","e","Promise","resolve","lookup","registryErr","proxy","hostname","parse","proxyErr"],"mappings":";;;;QAiBgBA,SAAS,GAATA,SAAS;AAjBA,GAAe,CAAf,aAAe;AACxB,GAAK,CAAL,IAAK;AACL,GAAK,CAAL,IAAK;;;;;;SAEZC,QAAQ,GAAuB,CAAC;IACvC,EAAE,EAAEC,OAAO,CAACC,GAAG,CAACC,WAAW,EAAE,CAAC;QAC5B,MAAM,CAACF,OAAO,CAACC,GAAG,CAACC,WAAW;IAChC,CAAC;IAED,GAAG,CAAC,CAAC;QACH,KAAK,CAACC,UAAU,OAVK,aAAe,WAUR,CAA4B,6BAAEC,QAAQ,GAAGC,IAAI;QACzE,MAAM,CAACF,UAAU,KAAK,CAAM,QAAGA,UAAU,GAAGG,SAAS;IACvD,CAAC,CAAC,KAAK,EAAEC,CAAC,EAAE,CAAC;QACX,MAAM;IACR,CAAC;AACH,CAAC;SAEeT,SAAS,GAAqB,CAAC;IAC7C,MAAM,CAAC,GAAG,CAACU,OAAO,EAAEC,OAAO,GAAK,CAAC;QAjBnB,IAAK,SAkBbC,MAAM,CAAC,CAAsB,wBAAGC,WAAW,GAAK,CAAC;YACnD,EAAE,GAAGA,WAAW,EAAE,CAAC;gBACjB,MAAM,CAACF,OAAO,CAAC,IAAI;YACrB,CAAC;YAED,KAAK,CAACG,KAAK,GAAGb,QAAQ;YACtB,EAAE,GAAGa,KAAK,EAAE,CAAC;gBACX,MAAM,CAACH,OAAO,CAAC,KAAK;YACtB,CAAC;YAED,KAAK,CAAC,CAAC,CAACI,QAAQ,EAAC,CAAC,GA3BR,IAAK,SA2BUC,KAAK,CAACF,KAAK;YACpC,EAAE,GAAGC,QAAQ,EAAE,CAAC;gBACd,MAAM,CAACJ,OAAO,CAAC,KAAK;YACtB,CAAC;YA/BS,IAAK,SAiCXC,MAAM,CAACG,QAAQ,GAAGE,QAAQ,GAAK,CAAC;gBAClCN,OAAO,CAACM,QAAQ,IAAI,IAAI;YAC1B,CAAC;QACH,CAAC;IACH,CAAC;AACH,CAAC"}