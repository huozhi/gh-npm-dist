{"version":3,"sources":["../../client/next-dev.js"],"sourcesContent":["import { initNext, version, router, emitter, render, renderError } from './'\nimport initOnDemandEntries from './dev/on-demand-entries-client'\nimport initWebpackHMR from './dev/webpack-hot-middleware-client'\nimport initializeBuildWatcher from './dev/dev-build-watcher'\nimport { displayContent } from './dev/fouc'\nimport { connectHMR, addMessageListener } from './dev/error-overlay/websocket'\nimport {\n  assign,\n  urlQueryToSearchParams,\n} from '../shared/lib/router/utils/querystring'\n\nconst {\n  __NEXT_DATA__: { assetPrefix },\n} = window\n\nconst prefix = assetPrefix || ''\nconst webpackHMR = initWebpackHMR()\n\nconnectHMR({ assetPrefix: prefix, path: '/_next/webpack-hmr' })\n\nif (!window._nextSetupHydrationWarning) {\n  const origConsoleError = window.console.error\n  window.console.error = (...args) => {\n    const isHydrateError = args.some(\n      (arg) =>\n        typeof arg === 'string' &&\n        arg.match(/Warning:.*?did not match.*?Server:/)\n    )\n    if (isHydrateError) {\n      args = [\n        ...args,\n        `\\n\\nSee more info here: https://nextjs.org/docs/messages/react-hydration-error`,\n      ]\n    }\n    origConsoleError.apply(window.console, args)\n  }\n  window._nextSetupHydrationWarning = true\n}\n\nwindow.next = {\n  version,\n  // router is initialized later so it has to be live-binded\n  get router() {\n    return router\n  },\n  emitter,\n  render,\n  renderError,\n}\ninitNext({ webpackHMR, beforeRender: displayContent })\n  .then(() => {\n    initOnDemandEntries()\n\n    let buildIndicatorHandler = () => {}\n\n    function devPagesManifestListener(event) {\n      if (event.data.indexOf('devPagesManifest') !== -1) {\n        fetch(`${prefix}/_next/static/development/_devPagesManifest.json`)\n          .then((res) => res.json())\n          .then((manifest) => {\n            window.__DEV_PAGES_MANIFEST = manifest\n          })\n          .catch((err) => {\n            console.log(`Failed to fetch devPagesManifest`, err)\n          })\n      } else if (event.data.indexOf('middlewareChanges') !== -1) {\n        return window.location.reload()\n      } else if (event.data.indexOf('serverOnlyChanges') !== -1) {\n        const { pages } = JSON.parse(event.data)\n\n        // Make sure to reload when the dev-overlay is showing for an\n        // API route\n        if (pages.includes(router.query.__NEXT_PAGE)) {\n          return window.location.reload()\n        }\n\n        if (!router.clc && pages.includes(router.pathname)) {\n          console.log('Refreshing page data due to server-side change')\n\n          buildIndicatorHandler('building')\n\n          const clearIndicator = () => buildIndicatorHandler('built')\n\n          router\n            .replace(\n              router.pathname +\n                '?' +\n                String(\n                  assign(\n                    urlQueryToSearchParams(router.query),\n                    new URLSearchParams(location.search)\n                  )\n                ),\n              router.asPath\n            )\n            .finally(clearIndicator)\n        }\n      }\n    }\n    addMessageListener(devPagesManifestListener)\n\n    if (process.env.__NEXT_BUILD_INDICATOR) {\n      initializeBuildWatcher((handler) => {\n        buildIndicatorHandler = handler\n      }, process.env.__NEXT_BUILD_INDICATOR_POSITION)\n    }\n  })\n  .catch((err) => {\n    console.error('Error was not caught', err)\n  })\n"],"names":["__NEXT_DATA__","assetPrefix","window","prefix","webpackHMR","path","_nextSetupHydrationWarning","origConsoleError","console","error","args","isHydrateError","some","arg","match","apply","next","version","router","emitter","render","renderError","beforeRender","then","buildIndicatorHandler","devPagesManifestListener","event","data","indexOf","fetch","res","json","manifest","__DEV_PAGES_MANIFEST","catch","err","log","location","reload","pages","JSON","parse","includes","query","__NEXT_PAGE","clc","pathname","clearIndicator","replace","String","URLSearchParams","search","asPath","finally","process","env","__NEXT_BUILD_INDICATOR","handler","__NEXT_BUILD_INDICATOR_POSITION"],"mappings":"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"}