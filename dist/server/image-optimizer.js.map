{"version":3,"sources":["../../server/image-optimizer.ts"],"sourcesContent":["import { mediaType } from 'next/dist/compiled/@hapi/accept'\nimport { createHash } from 'crypto'\nimport { createReadStream, promises } from 'fs'\nimport { getOrientation, Orientation } from 'next/dist/compiled/get-orientation'\nimport imageSizeOf from 'next/dist/compiled/image-size'\nimport { IncomingMessage, ServerResponse } from 'http'\n// @ts-ignore no types for is-animated\nimport isAnimated from 'next/dist/compiled/is-animated'\nimport contentDisposition from 'next/dist/compiled/content-disposition'\nimport { join } from 'path'\nimport Stream from 'stream'\nimport nodeUrl, { UrlWithParsedQuery } from 'url'\nimport { NextConfig } from './config-shared'\nimport { fileExists } from '../lib/file-exists'\nimport { ImageConfig, imageConfigDefault } from './image-config'\nimport { processBuffer, decodeBuffer, Operation } from './lib/squoosh/main'\nimport { sendEtagResponse } from './send-payload'\nimport { getContentType, getExtension } from './serve-static'\nimport chalk from 'next/dist/compiled/chalk'\nimport { NextUrlWithParsedQuery } from './request-meta'\n\ntype XCacheHeader = 'MISS' | 'HIT' | 'STALE'\n\nconst AVIF = 'image/avif'\nconst WEBP = 'image/webp'\nconst PNG = 'image/png'\nconst JPEG = 'image/jpeg'\nconst GIF = 'image/gif'\nconst SVG = 'image/svg+xml'\nconst CACHE_VERSION = 3\nconst ANIMATABLE_TYPES = [WEBP, PNG, GIF]\nconst VECTOR_TYPES = [SVG]\nconst BLUR_IMG_SIZE = 8 // should match `next-image-loader`\nconst inflightRequests = new Map<string, Promise<void>>()\n\nlet sharp:\n  | ((\n      input?: string | Buffer,\n      options?: import('sharp').SharpOptions\n    ) => import('sharp').Sharp)\n  | undefined\n\ntry {\n  sharp = require(process.env.NEXT_SHARP_PATH || 'sharp')\n} catch (e) {\n  // Sharp not present on the server, Squoosh fallback will be used\n}\n\nlet showSharpMissingWarning = process.env.NODE_ENV === 'production'\n\nexport async function imageOptimizer(\n  req: IncomingMessage,\n  res: ServerResponse,\n  parsedUrl: UrlWithParsedQuery,\n  nextConfig: NextConfig,\n  distDir: string,\n  render404: () => Promise<void>,\n  handleRequest: (\n    newReq: IncomingMessage,\n    newRes: ServerResponse,\n    newParsedUrl?: NextUrlWithParsedQuery\n  ) => Promise<void>,\n  isDev = false\n) {\n  const imageData: ImageConfig = nextConfig.images || imageConfigDefault\n  const {\n    deviceSizes = [],\n    imageSizes = [],\n    domains = [],\n    loader,\n    minimumCacheTTL = 60,\n    formats = ['image/webp'],\n  } = imageData\n\n  if (loader !== 'default') {\n    await render404()\n    return { finished: true }\n  }\n\n  const { headers } = req\n  const { url, w, q } = parsedUrl.query\n  const mimeType = getSupportedMimeType(formats, headers.accept)\n  let href: string\n\n  if (!url) {\n    res.statusCode = 400\n    res.end('\"url\" parameter is required')\n    return { finished: true }\n  } else if (Array.isArray(url)) {\n    res.statusCode = 400\n    res.end('\"url\" parameter cannot be an array')\n    return { finished: true }\n  }\n\n  let isAbsolute: boolean\n\n  if (url.startsWith('/')) {\n    href = url\n    isAbsolute = false\n  } else {\n    let hrefParsed: URL\n\n    try {\n      hrefParsed = new URL(url)\n      href = hrefParsed.toString()\n      isAbsolute = true\n    } catch (_error) {\n      res.statusCode = 400\n      res.end('\"url\" parameter is invalid')\n      return { finished: true }\n    }\n\n    if (!['http:', 'https:'].includes(hrefParsed.protocol)) {\n      res.statusCode = 400\n      res.end('\"url\" parameter is invalid')\n      return { finished: true }\n    }\n\n    if (!domains.includes(hrefParsed.hostname)) {\n      res.statusCode = 400\n      res.end('\"url\" parameter is not allowed')\n      return { finished: true }\n    }\n  }\n\n  if (!w) {\n    res.statusCode = 400\n    res.end('\"w\" parameter (width) is required')\n    return { finished: true }\n  } else if (Array.isArray(w)) {\n    res.statusCode = 400\n    res.end('\"w\" parameter (width) cannot be an array')\n    return { finished: true }\n  }\n\n  if (!q) {\n    res.statusCode = 400\n    res.end('\"q\" parameter (quality) is required')\n    return { finished: true }\n  } else if (Array.isArray(q)) {\n    res.statusCode = 400\n    res.end('\"q\" parameter (quality) cannot be an array')\n    return { finished: true }\n  }\n\n  // Should match output from next-image-loader\n  const isStatic = url.startsWith(\n    `${nextConfig.basePath || ''}/_next/static/media`\n  )\n\n  const width = parseInt(w, 10)\n\n  if (!width || isNaN(width)) {\n    res.statusCode = 400\n    res.end('\"w\" parameter (width) must be a number greater than 0')\n    return { finished: true }\n  }\n\n  const sizes = [...deviceSizes, ...imageSizes]\n\n  if (isDev) {\n    sizes.push(BLUR_IMG_SIZE)\n  }\n\n  if (!sizes.includes(width)) {\n    res.statusCode = 400\n    res.end(`\"w\" parameter (width) of ${width} is not allowed`)\n    return { finished: true }\n  }\n\n  const quality = parseInt(q)\n\n  if (isNaN(quality) || quality < 1 || quality > 100) {\n    res.statusCode = 400\n    res.end('\"q\" parameter (quality) must be a number between 1 and 100')\n    return { finished: true }\n  }\n\n  const hash = getHash([CACHE_VERSION, href, width, quality, mimeType])\n  const imagesDir = join(distDir, 'cache', 'images')\n  const hashDir = join(imagesDir, hash)\n  const now = Date.now()\n  let xCache: XCacheHeader = 'MISS'\n\n  // If there're concurrent requests hitting the same resource and it's still\n  // being optimized, wait before accessing the cache.\n  if (inflightRequests.has(hash)) {\n    await inflightRequests.get(hash)\n  }\n  const dedupe = new Deferred<void>()\n  inflightRequests.set(hash, dedupe.promise)\n\n  try {\n    if (await fileExists(hashDir, 'directory')) {\n      const files = await promises.readdir(hashDir)\n      for (let file of files) {\n        const [maxAgeStr, expireAtSt, etag, extension] = file.split('.')\n        const maxAge = Number(maxAgeStr)\n        const expireAt = Number(expireAtSt)\n        const contentType = getContentType(extension)\n        const fsPath = join(hashDir, file)\n        xCache = now < expireAt ? 'HIT' : 'STALE'\n        const result = setResponseHeaders(\n          req,\n          res,\n          url,\n          etag,\n          maxAge,\n          contentType,\n          isStatic,\n          isDev,\n          xCache\n        )\n        if (!result.finished) {\n          await new Promise<void>((resolve, reject) => {\n            createReadStream(fsPath)\n              .on('end', resolve)\n              .on('error', reject)\n              .pipe(res)\n          })\n        }\n        if (xCache === 'HIT') {\n          return { finished: true }\n        } else {\n          await promises.unlink(fsPath)\n        }\n      }\n    }\n\n    let upstreamBuffer: Buffer\n    let upstreamType: string | null\n    let maxAge: number\n\n    if (isAbsolute) {\n      const upstreamRes = await fetch(href)\n\n      if (!upstreamRes.ok) {\n        res.statusCode = upstreamRes.status\n        res.end('\"url\" parameter is valid but upstream response is invalid')\n        return { finished: true }\n      }\n\n      res.statusCode = upstreamRes.status\n      upstreamBuffer = Buffer.from(await upstreamRes.arrayBuffer())\n      upstreamType =\n        detectContentType(upstreamBuffer) ||\n        upstreamRes.headers.get('Content-Type')\n      maxAge = getMaxAge(upstreamRes.headers.get('Cache-Control'))\n    } else {\n      try {\n        const resBuffers: Buffer[] = []\n        const mockRes: any = new Stream.Writable()\n\n        const isStreamFinished = new Promise(function (resolve, reject) {\n          mockRes.on('finish', () => resolve(true))\n          mockRes.on('end', () => resolve(true))\n          mockRes.on('error', () => reject())\n        })\n\n        mockRes.write = (chunk: Buffer | string) => {\n          resBuffers.push(Buffer.isBuffer(chunk) ? chunk : Buffer.from(chunk))\n        }\n        mockRes._write = (\n          chunk: Buffer | string,\n          _encoding: string,\n          callback: () => void\n        ) => {\n          mockRes.write(chunk)\n          // According to Node.js documentation, the callback MUST be invoked to signal that\n          // the write completed successfully. If this callback is not invoked, the 'finish' event\n          // will not be emitted.\n          // https://nodejs.org/docs/latest-v16.x/api/stream.html#writable_writechunk-encoding-callback\n          callback()\n        }\n\n        const mockHeaders: Record<string, string | string[]> = {}\n\n        mockRes.writeHead = (_status: any, _headers: any) =>\n          Object.assign(mockHeaders, _headers)\n        mockRes.getHeader = (name: string) => mockHeaders[name.toLowerCase()]\n        mockRes.getHeaders = () => mockHeaders\n        mockRes.getHeaderNames = () => Object.keys(mockHeaders)\n        mockRes.setHeader = (name: string, value: string | string[]) =>\n          (mockHeaders[name.toLowerCase()] = value)\n        mockRes.removeHeader = (name: string) => {\n          delete mockHeaders[name.toLowerCase()]\n        }\n        mockRes._implicitHeader = () => {}\n        mockRes.connection = res.connection\n        mockRes.finished = false\n        mockRes.statusCode = 200\n\n        const mockReq: any = new Stream.Readable()\n\n        mockReq._read = () => {\n          mockReq.emit('end')\n          mockReq.emit('close')\n          return Buffer.from('')\n        }\n\n        mockReq.headers = req.headers\n        mockReq.method = req.method\n        mockReq.url = href\n        mockReq.connection = req.connection\n\n        await handleRequest(mockReq, mockRes, nodeUrl.parse(href, true))\n        await isStreamFinished\n        res.statusCode = mockRes.statusCode\n        upstreamBuffer = Buffer.concat(resBuffers)\n        upstreamType =\n          detectContentType(upstreamBuffer) || mockRes.getHeader('Content-Type')\n        maxAge = getMaxAge(mockRes.getHeader('Cache-Control'))\n      } catch (err) {\n        res.statusCode = 500\n        res.end('\"url\" parameter is valid but upstream response is invalid')\n        return { finished: true }\n      }\n    }\n\n    const expireAt = Math.max(maxAge, minimumCacheTTL) * 1000 + now\n\n    if (upstreamType) {\n      const vector = VECTOR_TYPES.includes(upstreamType)\n      const animate =\n        ANIMATABLE_TYPES.includes(upstreamType) && isAnimated(upstreamBuffer)\n      if (vector || animate) {\n        await writeToCacheDir(\n          hashDir,\n          upstreamType,\n          maxAge,\n          expireAt,\n          upstreamBuffer\n        )\n        sendResponse(\n          req,\n          res,\n          url,\n          maxAge,\n          upstreamType,\n          upstreamBuffer,\n          isStatic,\n          isDev,\n          xCache\n        )\n        return { finished: true }\n      }\n      if (!upstreamType.startsWith('image/')) {\n        res.statusCode = 400\n        res.end(\"The requested resource isn't a valid image.\")\n        return { finished: true }\n      }\n    }\n\n    let contentType: string\n\n    if (mimeType) {\n      contentType = mimeType\n    } else if (\n      upstreamType?.startsWith('image/') &&\n      getExtension(upstreamType)\n    ) {\n      contentType = upstreamType\n    } else {\n      contentType = JPEG\n    }\n    try {\n      let optimizedBuffer: Buffer | undefined\n      if (sharp) {\n        // Begin sharp transformation logic\n        const transformer = sharp(upstreamBuffer)\n\n        transformer.rotate()\n\n        const { width: metaWidth } = await transformer.metadata()\n\n        if (metaWidth && metaWidth > width) {\n          transformer.resize(width)\n        }\n\n        if (contentType === AVIF) {\n          if (transformer.avif) {\n            const avifQuality = quality - 15\n            transformer.avif({\n              quality: Math.max(avifQuality, 0),\n              chromaSubsampling: '4:2:0', // same as webp\n            })\n          } else {\n            console.warn(\n              chalk.yellow.bold('Warning: ') +\n                `Your installed version of the 'sharp' package does not support AVIF images. Run 'yarn add sharp@latest' to upgrade to the latest version.\\n` +\n                'Read more: https://nextjs.org/docs/messages/sharp-version-avif'\n            )\n            transformer.webp({ quality })\n          }\n        } else if (contentType === WEBP) {\n          transformer.webp({ quality })\n        } else if (contentType === PNG) {\n          transformer.png({ quality })\n        } else if (contentType === JPEG) {\n          transformer.jpeg({ quality })\n        }\n\n        optimizedBuffer = await transformer.toBuffer()\n        // End sharp transformation logic\n      } else {\n        if (\n          showSharpMissingWarning &&\n          nextConfig.experimental?.outputStandalone\n        ) {\n          // TODO: should we ensure squoosh also works even though we don't\n          // recommend it be used in production and this is a production feature\n          console.error(\n            `Error: 'sharp' is required to be installed in standalone mode for the image optimization to function correctly`\n          )\n          req.statusCode = 500\n          res.end('internal server error')\n          return { finished: true }\n        }\n        // Show sharp warning in production once\n        if (showSharpMissingWarning) {\n          console.warn(\n            chalk.yellow.bold('Warning: ') +\n              `For production Image Optimization with Next.js, the optional 'sharp' package is strongly recommended. Run 'yarn add sharp', and Next.js will use it automatically for Image Optimization.\\n` +\n              'Read more: https://nextjs.org/docs/messages/sharp-missing-in-production'\n          )\n          showSharpMissingWarning = false\n        }\n\n        // Begin Squoosh transformation logic\n        const orientation = await getOrientation(upstreamBuffer)\n\n        const operations: Operation[] = []\n\n        if (orientation === Orientation.RIGHT_TOP) {\n          operations.push({ type: 'rotate', numRotations: 1 })\n        } else if (orientation === Orientation.BOTTOM_RIGHT) {\n          operations.push({ type: 'rotate', numRotations: 2 })\n        } else if (orientation === Orientation.LEFT_BOTTOM) {\n          operations.push({ type: 'rotate', numRotations: 3 })\n        } else {\n          // TODO: support more orientations\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          // const _: never = orientation\n        }\n\n        operations.push({ type: 'resize', width })\n\n        if (contentType === AVIF) {\n          optimizedBuffer = await processBuffer(\n            upstreamBuffer,\n            operations,\n            'avif',\n            quality\n          )\n        } else if (contentType === WEBP) {\n          optimizedBuffer = await processBuffer(\n            upstreamBuffer,\n            operations,\n            'webp',\n            quality\n          )\n        } else if (contentType === PNG) {\n          optimizedBuffer = await processBuffer(\n            upstreamBuffer,\n            operations,\n            'png',\n            quality\n          )\n        } else if (contentType === JPEG) {\n          optimizedBuffer = await processBuffer(\n            upstreamBuffer,\n            operations,\n            'jpeg',\n            quality\n          )\n        }\n\n        // End Squoosh transformation logic\n      }\n      if (optimizedBuffer) {\n        await writeToCacheDir(\n          hashDir,\n          contentType,\n          maxAge,\n          expireAt,\n          optimizedBuffer\n        )\n        sendResponse(\n          req,\n          res,\n          url,\n          maxAge,\n          contentType,\n          optimizedBuffer,\n          isStatic,\n          isDev,\n          xCache\n        )\n      } else {\n        throw new Error('Unable to optimize buffer')\n      }\n    } catch (error) {\n      sendResponse(\n        req,\n        res,\n        url,\n        maxAge,\n        upstreamType,\n        upstreamBuffer,\n        isStatic,\n        isDev,\n        xCache\n      )\n    }\n\n    return { finished: true }\n  } finally {\n    dedupe.resolve()\n    inflightRequests.delete(hash)\n  }\n}\n\nasync function writeToCacheDir(\n  dir: string,\n  contentType: string,\n  maxAge: number,\n  expireAt: number,\n  buffer: Buffer\n) {\n  await promises.mkdir(dir, { recursive: true })\n  const extension = getExtension(contentType)\n  const etag = getHash([buffer])\n  const filename = join(dir, `${maxAge}.${expireAt}.${etag}.${extension}`)\n  await promises.writeFile(filename, buffer)\n}\n\nfunction getFileNameWithExtension(\n  url: string,\n  contentType: string | null\n): string | void {\n  const [urlWithoutQueryParams] = url.split('?')\n  const fileNameWithExtension = urlWithoutQueryParams.split('/').pop()\n  if (!contentType || !fileNameWithExtension) {\n    return\n  }\n\n  const [fileName] = fileNameWithExtension.split('.')\n  const extension = getExtension(contentType)\n  return `${fileName}.${extension}`\n}\n\nfunction setResponseHeaders(\n  req: IncomingMessage,\n  res: ServerResponse,\n  url: string,\n  etag: string,\n  maxAge: number,\n  contentType: string | null,\n  isStatic: boolean,\n  isDev: boolean,\n  xCache: XCacheHeader\n) {\n  res.setHeader('Vary', 'Accept')\n  res.setHeader(\n    'Cache-Control',\n    isStatic\n      ? 'public, max-age=315360000, immutable'\n      : `public, max-age=${isDev ? 0 : maxAge}, must-revalidate`\n  )\n  if (sendEtagResponse(req, res, etag)) {\n    // already called res.end() so we're finished\n    return { finished: true }\n  }\n  if (contentType) {\n    res.setHeader('Content-Type', contentType)\n  }\n\n  const fileName = getFileNameWithExtension(url, contentType)\n  if (fileName) {\n    res.setHeader(\n      'Content-Disposition',\n      contentDisposition(fileName, { type: 'inline' })\n    )\n  }\n\n  res.setHeader('Content-Security-Policy', `script-src 'none'; sandbox;`)\n  res.setHeader('X-Nextjs-Cache', xCache)\n\n  return { finished: false }\n}\n\nfunction sendResponse(\n  req: IncomingMessage,\n  res: ServerResponse,\n  url: string,\n  maxAge: number,\n  contentType: string | null,\n  buffer: Buffer,\n  isStatic: boolean,\n  isDev: boolean,\n  xCache: XCacheHeader\n) {\n  if (xCache === 'STALE') {\n    return\n  }\n  const etag = getHash([buffer])\n  const result = setResponseHeaders(\n    req,\n    res,\n    url,\n    etag,\n    maxAge,\n    contentType,\n    isStatic,\n    isDev,\n    xCache\n  )\n  if (!result.finished) {\n    res.end(buffer)\n  }\n}\n\nfunction getSupportedMimeType(options: string[], accept = ''): string {\n  const mimeType = mediaType(accept, options)\n  return accept.includes(mimeType) ? mimeType : ''\n}\n\nfunction getHash(items: (string | number | Buffer)[]) {\n  const hash = createHash('sha256')\n  for (let item of items) {\n    if (typeof item === 'number') hash.update(String(item))\n    else {\n      hash.update(item)\n    }\n  }\n  // See https://en.wikipedia.org/wiki/Base64#Filenames\n  return hash.digest('base64').replace(/\\//g, '-')\n}\n\nfunction parseCacheControl(str: string | null): Map<string, string> {\n  const map = new Map<string, string>()\n  if (!str) {\n    return map\n  }\n  for (let directive of str.split(',')) {\n    let [key, value] = directive.trim().split('=')\n    key = key.toLowerCase()\n    if (value) {\n      value = value.toLowerCase()\n    }\n    map.set(key, value)\n  }\n  return map\n}\n\n/**\n * Inspects the first few bytes of a buffer to determine if\n * it matches the \"magic number\" of known file signatures.\n * https://en.wikipedia.org/wiki/List_of_file_signatures\n */\nexport function detectContentType(buffer: Buffer) {\n  if ([0xff, 0xd8, 0xff].every((b, i) => buffer[i] === b)) {\n    return JPEG\n  }\n  if (\n    [0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a].every(\n      (b, i) => buffer[i] === b\n    )\n  ) {\n    return PNG\n  }\n  if ([0x47, 0x49, 0x46, 0x38].every((b, i) => buffer[i] === b)) {\n    return GIF\n  }\n  if (\n    [0x52, 0x49, 0x46, 0x46, 0, 0, 0, 0, 0x57, 0x45, 0x42, 0x50].every(\n      (b, i) => !b || buffer[i] === b\n    )\n  ) {\n    return WEBP\n  }\n  if ([0x3c, 0x3f, 0x78, 0x6d, 0x6c].every((b, i) => buffer[i] === b)) {\n    return SVG\n  }\n  if (\n    [0, 0, 0, 0, 0x66, 0x74, 0x79, 0x70, 0x61, 0x76, 0x69, 0x66].every(\n      (b, i) => !b || buffer[i] === b\n    )\n  ) {\n    return AVIF\n  }\n  return null\n}\n\nexport function getMaxAge(str: string | null): number {\n  const map = parseCacheControl(str)\n  if (map) {\n    let age = map.get('s-maxage') || map.get('max-age') || ''\n    if (age.startsWith('\"') && age.endsWith('\"')) {\n      age = age.slice(1, -1)\n    }\n    const n = parseInt(age, 10)\n    if (!isNaN(n)) {\n      return n\n    }\n  }\n  return 0\n}\n\nexport async function resizeImage(\n  content: Buffer,\n  dimension: 'width' | 'height',\n  size: number,\n  // Should match VALID_BLUR_EXT\n  extension: 'avif' | 'webp' | 'png' | 'jpeg',\n  quality: number\n): Promise<Buffer> {\n  if (sharp) {\n    const transformer = sharp(content)\n\n    if (extension === 'avif') {\n      if (transformer.avif) {\n        transformer.avif({ quality })\n      } else {\n        console.warn(\n          chalk.yellow.bold('Warning: ') +\n            `Your installed version of the 'sharp' package does not support AVIF images. Run 'yarn add sharp@latest' to upgrade to the latest version.\\n` +\n            'Read more: https://nextjs.org/docs/messages/sharp-version-avif'\n        )\n        transformer.webp({ quality })\n      }\n    } else if (extension === 'webp') {\n      transformer.webp({ quality })\n    } else if (extension === 'png') {\n      transformer.png({ quality })\n    } else if (extension === 'jpeg') {\n      transformer.jpeg({ quality })\n    }\n    if (dimension === 'width') {\n      transformer.resize(size)\n    } else {\n      transformer.resize(null, size)\n    }\n    const buf = await transformer.toBuffer()\n    return buf\n  } else {\n    const resizeOperationOpts: Operation =\n      dimension === 'width'\n        ? { type: 'resize', width: size }\n        : { type: 'resize', height: size }\n    const buf = await processBuffer(\n      content,\n      [resizeOperationOpts],\n      extension,\n      quality\n    )\n    return buf\n  }\n}\n\nexport async function getImageSize(\n  buffer: Buffer,\n  // Should match VALID_BLUR_EXT\n  extension: 'avif' | 'webp' | 'png' | 'jpeg'\n): Promise<{\n  width?: number\n  height?: number\n}> {\n  // TODO: upgrade \"image-size\" package to support AVIF\n  // See https://github.com/image-size/image-size/issues/348\n  if (extension === 'avif') {\n    if (sharp) {\n      const transformer = sharp(buffer)\n      const { width, height } = await transformer.metadata()\n      return { width, height }\n    } else {\n      const { width, height } = await decodeBuffer(buffer)\n      return { width, height }\n    }\n  }\n\n  const { width, height } = imageSizeOf(buffer)\n  return { width, height }\n}\n\nexport class Deferred<T> {\n  promise: Promise<T>\n  resolve!: (value: T) => void\n  reject!: (error?: Error) => void\n\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve\n      this.reject = reject\n    })\n  }\n}\n"],"names":["imageOptimizer","detectContentType","getMaxAge","resizeImage","getImageSize","AVIF","WEBP","PNG","JPEG","GIF","SVG","CACHE_VERSION","ANIMATABLE_TYPES","VECTOR_TYPES","BLUR_IMG_SIZE","inflightRequests","Map","sharp","require","process","env","NEXT_SHARP_PATH","e","showSharpMissingWarning","NODE_ENV","req","res","parsedUrl","nextConfig","distDir","render404","handleRequest","isDev","imageData","images","deviceSizes","imageSizes","domains","loader","minimumCacheTTL","formats","finished","headers","url","w","q","query","mimeType","getSupportedMimeType","accept","href","statusCode","end","Array","isArray","isAbsolute","startsWith","hrefParsed","URL","toString","_error","includes","protocol","hostname","isStatic","basePath","width","parseInt","isNaN","sizes","push","quality","hash","getHash","imagesDir","hashDir","now","Date","xCache","has","get","dedupe","Deferred","set","promise","files","readdir","file","maxAgeStr","expireAtSt","etag","extension","split","maxAge","Number","expireAt","contentType","fsPath","result","setResponseHeaders","Promise","resolve","reject","on","pipe","unlink","upstreamBuffer","upstreamType","upstreamRes","fetch","ok","status","Buffer","from","arrayBuffer","resBuffers","mockRes","Writable","isStreamFinished","write","chunk","isBuffer","_write","_encoding","callback","mockHeaders","writeHead","_status","_headers","Object","assign","getHeader","name","toLowerCase","getHeaders","getHeaderNames","keys","setHeader","value","removeHeader","_implicitHeader","connection","mockReq","Readable","_read","emit","method","parse","concat","err","Math","max","vector","animate","writeToCacheDir","sendResponse","optimizedBuffer","transformer","rotate","metaWidth","metadata","resize","avif","avifQuality","chromaSubsampling","console","warn","yellow","bold","webp","png","jpeg","toBuffer","experimental","outputStandalone","error","orientation","operations","RIGHT_TOP","type","numRotations","BOTTOM_RIGHT","LEFT_BOTTOM","Error","delete","dir","buffer","mkdir","recursive","filename","writeFile","getFileNameWithExtension","urlWithoutQueryParams","fileNameWithExtension","pop","fileName","options","items","item","update","String","digest","replace","parseCacheControl","str","map","directive","key","trim","every","b","i","age","endsWith","slice","n","content","dimension","size","buf","resizeOperationOpts","height"],"mappings":"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"}