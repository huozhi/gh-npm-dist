{"version":3,"sources":["../../server/config-shared.ts"],"sourcesContent":["import os from 'os'\nimport type { webpack5 } from 'next/dist/compiled/webpack/webpack'\nimport { Header, Redirect, Rewrite } from '../lib/load-custom-routes'\nimport {\n  ImageConfig,\n  ImageConfigComplete,\n  imageConfigDefault,\n} from './image-config'\n\nexport type NextConfigComplete = Required<NextConfig> & {\n  images: ImageConfigComplete\n  typescript: Required<TypeScriptConfig>\n  configOrigin?: string\n  configFile?: string\n  configFileName: string\n}\n\nexport interface I18NConfig {\n  defaultLocale: string\n  domains?: DomainLocale[]\n  localeDetection?: false\n  locales: string[]\n}\n\nexport interface DomainLocale {\n  defaultLocale: string\n  domain: string\n  http?: true\n  locales?: string[]\n}\n\nexport interface ESLintConfig {\n  /** Only run ESLint on these directories with `next lint` and `next build`. */\n  dirs?: string[]\n  /** Do not run ESLint during production builds (`next build`). */\n  ignoreDuringBuilds?: boolean\n}\n\nexport interface TypeScriptConfig {\n  /** Do not run TypeScript during production builds (`next build`). */\n  ignoreBuildErrors?: boolean\n  /** Relative path to a custom tsconfig file */\n  tsconfigPath?: string\n}\n\nexport interface WebpackConfigContext {\n  /** Next.js root directory */\n  dir: string\n  /** Indicates if the compilation will be done in development */\n  dev: boolean\n  /** It's `true` for server-side compilation, and `false` for client-side compilation */\n  isServer: boolean\n  /**  The build id, used as a unique identifier between builds */\n  buildId: string\n  /** The next.config.js merged with default values */\n  config: NextConfigComplete\n  /** Default loaders used internally by Next.js */\n  defaultLoaders: {\n    /** Default babel-loader configuration */\n    babel: any\n  }\n  /** Number of total Next.js pages */\n  totalPages: number\n  /** The webpack configuration */\n  webpack: any\n}\n\nexport interface NextJsWebpackConfig {\n  (\n    /** Existing Webpack config */\n    config: any,\n    context: WebpackConfigContext\n  ): any\n}\n\nexport interface ExperimentalConfig {\n  disablePostcssPresetEnv?: boolean\n  removeConsole?:\n    | boolean\n    | {\n        exclude?: string[]\n      }\n  reactRemoveProperties?:\n    | boolean\n    | {\n        properties?: string[]\n      }\n  styledComponents?: boolean\n  swcMinify?: boolean\n  swcFileReading?: boolean\n  cpus?: number\n  sharedPool?: boolean\n  plugins?: boolean\n  profiling?: boolean\n  isrFlushToDisk?: boolean\n  reactMode?: 'legacy' | 'concurrent' | 'blocking'\n  workerThreads?: boolean\n  pageEnv?: boolean\n  optimizeImages?: boolean\n  optimizeCss?: boolean\n  scrollRestoration?: boolean\n  externalDir?: boolean\n  conformance?: boolean\n  amp?: {\n    optimizer?: any\n    validator?: string\n    skipValidation?: boolean\n  }\n  reactRoot?: boolean\n  disableOptimizedLoading?: boolean\n  gzipSize?: boolean\n  craCompat?: boolean\n  esmExternals?: boolean | 'loose'\n  isrMemoryCacheSize?: number\n  concurrentFeatures?: boolean\n  serverComponents?: boolean\n  fullySpecified?: boolean\n  urlImports?: NonNullable<webpack5.Configuration['experiments']>['buildHttp']\n  outputFileTracingRoot?: string\n  outputStandalone?: boolean\n  relay?: {\n    src: string\n    artifactDirectory?: string\n    language?: 'typescript' | 'flow'\n  }\n}\n\n/**\n * Next configuration object\n * @see [configuration documentation](https://nextjs.org/docs/api-reference/next.config.js/introduction)\n */\nexport interface NextConfig extends Record<string, any> {\n  /**\n   * Internationalization configuration\n   *\n   * @see [Internationalization docs](https://nextjs.org/docs/advanced-features/i18n-routing)\n   */\n  i18n?: I18NConfig | null\n\n  /**\n   * @since version 11\n   * @see [ESLint configuration](https://nextjs.org/docs/basic-features/eslint)\n   */\n  eslint?: ESLintConfig\n\n  /**\n   * @see [Next.js TypeScript documentation](https://nextjs.org/docs/basic-features/typescript)\n   */\n  typescript?: TypeScriptConfig\n\n  /**\n   * Headers allow you to set custom HTTP headers for an incoming request path.\n   *\n   * @see [Headers configuration documentation](https://nextjs.org/docs/api-reference/next.config.js/headers)\n   */\n  headers?: () => Promise<Header[]>\n\n  /**\n   * Rewrites allow you to map an incoming request path to a different destination path.\n   *\n   * @see [Rewrites configuration documentation](https://nextjs.org/docs/api-reference/next.config.js/rewrites)\n   */\n  rewrites?: () => Promise<\n    | Rewrite[]\n    | {\n        beforeFiles: Rewrite[]\n        afterFiles: Rewrite[]\n        fallback: Rewrite[]\n      }\n  >\n\n  /**\n   * Redirects allow you to redirect an incoming request path to a different destination path.\n   *\n   * @see [Redirects configuration documentation](https://nextjs.org/docs/api-reference/next.config.js/redirects)\n   */\n  redirects?: () => Promise<Redirect[]>\n\n  /**\n   * @deprecated This option has been removed as webpack 5 is now default\n   * @see [Next.js webpack 5 documentation](https://nextjs.org/docs/messages/webpack5) for upgrading guidance.\n   */\n  webpack5?: false\n\n  /**\n   * @see [Moment.js locales excluded by default](https://nextjs.org/docs/upgrading#momentjs-locales-excluded-by-default)\n   */\n  excludeDefaultMomentLocales?: boolean\n\n  /**\n   * Before continuing to add custom webpack configuration to your application make sure Next.js doesn't already support your use-case\n   *\n   * @see [Custom Webpack Config documentation](https://nextjs.org/docs/api-reference/next.config.js/custom-webpack-config)\n   */\n  webpack?: NextJsWebpackConfig | null\n\n  /**\n   * By default Next.js will redirect urls with trailing slashes to their counterpart without a trailing slash.\n   *\n   * @default false\n   * @see [Trailing Slash Configuration](https://nextjs.org/docs/api-reference/next.config.js/trailing-slash)\n   */\n  trailingSlash?: boolean\n\n  /**\n   * Next.js comes with built-in support for environment variables\n   *\n   * @see [Environment Variables documentation](https://nextjs.org/docs/api-reference/next.config.js/environment-variables)\n   */\n  env?: Record<string, string>\n\n  /**\n   * Destination directory (defaults to `.next`)\n   */\n  distDir?: string\n\n  /**\n   * The build output directory (defaults to `.next`) is now cleared by default except for the Next.js caches.\n   */\n  cleanDistDir?: boolean\n\n  /**\n   * To set up a CDN, you can set up an asset prefix and configure your CDN's origin to resolve to the domain that Next.js is hosted on.\n   *\n   * @see [CDN Support with Asset Prefix](https://nextjs.org/docs/api-reference/next.config.js/cdn-support-with-asset-prefix)\n   */\n  assetPrefix?: string\n\n  /**\n   * By default, `Next` will serve each file in the `pages` folder under a pathname matching the filename.\n   * To disable this behavior and prevent routing based set this to `true`.\n   *\n   * @default true\n   * @see [Disabling file-system routing](https://nextjs.org/docs/advanced-features/custom-server#disabling-file-system-routing)\n   */\n  useFileSystemPublicRoutes?: boolean\n\n  /**\n   * @see [Configuring the build ID](https://nextjs.org/docs/api-reference/next.config.js/configuring-the-build-id)\n   */\n  generateBuildId?: () => string | null | Promise<string | null>\n\n  /** @see [Disabling ETag Configuration](https://nextjs.org/docs/api-reference/next.config.js/disabling-etag-generation) */\n  generateEtags?: boolean\n\n  /** @see [Including non-page files in the pages directory](https://nextjs.org/docs/api-reference/next.config.js/custom-page-extensions) */\n  pageExtensions?: string[]\n\n  /** @see [Compression documentation](https://nextjs.org/docs/api-reference/next.config.js/compression) */\n  compress?: boolean\n\n  /** @see [Disabling x-powered-by](https://nextjs.org/docs/api-reference/next.config.js/disabling-x-powered-by) */\n  poweredByHeader?: boolean\n\n  /** @see [Using the Image Component](https://nextjs.org/docs/basic-features/image-optimization#using-the-image-component) */\n  images?: ImageConfig\n\n  /** Configure indicators in development environment */\n  devIndicators?: {\n    /** Show \"building...\"\" indicator in development */\n    buildActivity?: boolean\n    /** Position of \"building...\" indicator in browser */\n    buildActivityPosition?:\n      | 'bottom-right'\n      | 'bottom-left'\n      | 'top-right'\n      | 'top-left'\n  }\n\n  /**\n   * Next.js exposes some options that give you some control over how the server will dispose or keep in memory built pages in development.\n   *\n   * @see [Configuring `onDemandEntries`](https://nextjs.org/docs/api-reference/next.config.js/configuring-onDemandEntries)\n   */\n  onDemandEntries?: {\n    /** period (in ms) where the server will keep pages in the buffer */\n    maxInactiveAge?: number\n    /** number of pages that should be kept simultaneously without being disposed */\n    pagesBufferLength?: number\n  }\n\n  /** @see [`next/amp`](https://nextjs.org/docs/api-reference/next/amp) */\n  amp?: {\n    canonicalBase?: string\n  }\n\n  /**\n   * Deploy a Next.js application under a sub-path of a domain\n   *\n   * @see [Base path configuration](https://nextjs.org/docs/api-reference/next.config.js/basepath)\n   */\n  basePath?: string\n\n  /** @see [Customizing sass options](https://nextjs.org/docs/basic-features/built-in-css-support#customizing-sass-options) */\n  sassOptions?: { [key: string]: any }\n\n  /**\n   * Enable browser source map generation during the production build\n   *\n   * @see [Source Maps](https://nextjs.org/docs/advanced-features/source-maps)\n   */\n  productionBrowserSourceMaps?: boolean\n\n  /**\n   * By default, Next.js will automatically inline font CSS at build time\n   *\n   * @default true\n   * @since version 10.2\n   * @see [Font Optimization](https://nextjs.org/docs/basic-features/font-optimization)\n   */\n  optimizeFonts?: boolean\n\n  /**\n   * The Next.js runtime is Strict Mode-compliant.\n   *\n   * @see [React Strict Mode](https://nextjs.org/docs/api-reference/next.config.js/react-strict-mode)\n   */\n  reactStrictMode?: boolean\n\n  /**\n   * Add public (in browser) runtime configuration to your app\n   *\n   * @see [Runtime configuration](https://nextjs.org/docs/api-reference/next.config.js/runtime-configuration)\n   */\n  publicRuntimeConfig?: { [key: string]: any }\n\n  /**\n   * Add server runtime configuration to your app\n   *\n   * @see [Runtime configuration](https://nextjs.org/docs/api-reference/next.config.js/runtime-configuration)\n   */\n  serverRuntimeConfig?: { [key: string]: any }\n\n  /**\n   * Next.js automatically polyfills node-fetch and enables HTTP Keep-Alive by default.\n   * You may want to disable HTTP Keep-Alive for certain `fetch()` calls or globally.\n   *\n   * @see [Disabling HTTP Keep-Alive](https://nextjs.org/docs/api-reference/next.config.js/disabling-http-keep-alive)\n   */\n  httpAgentOptions?: { keepAlive?: boolean }\n\n  future?: {\n    /**\n     * @deprecated This option has been removed as webpack 5 is now default\n     */\n    webpack5?: false\n  }\n\n  /**\n   * During a build, Next.js will automatically trace each page and its dependencies to determine all of the files\n   * that are needed for deploying a production version of your application.\n   *\n   * @see [Output File Tracing](https://nextjs.org/docs/advanced-features/output-file-tracing)\n   */\n  outputFileTracing?: boolean\n\n  /**\n   * Timeout after waiting to generate static pages in seconds\n   *\n   * @default 60\n   */\n  staticPageGenerationTimeout?: number\n\n  /**\n   * Add `\"crossorigin\"` attribute to generated `<script>` elements generated by `<Head />` or `<NextScript />` components\n   *\n   *\n   * @see [`crossorigin` attribute documentation](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin)\n   */\n  crossOrigin?: false | 'anonymous' | 'use-credentials'\n\n  /**\n   * Use [SWC compiler](https://swc.rs) to minify the generated JavaScript\n   *\n   * @see [SWC Minification](https://nextjs.org/docs/advanced-features/compiler#minification)\n   */\n  swcMinify?: boolean\n\n  /**\n   * Enable experimental features. Note that all experimental features are subject to breaking changes in the future.\n   */\n  experimental?: ExperimentalConfig\n}\n\nexport const defaultConfig: NextConfig = {\n  env: {},\n  webpack: null,\n  webpackDevMiddleware: null,\n  eslint: {\n    ignoreDuringBuilds: false,\n  },\n  typescript: {\n    ignoreBuildErrors: false,\n    tsconfigPath: 'tsconfig.json',\n  },\n  distDir: '.next',\n  cleanDistDir: true,\n  assetPrefix: '',\n  configOrigin: 'default',\n  useFileSystemPublicRoutes: true,\n  generateBuildId: () => null,\n  generateEtags: true,\n  pageExtensions: ['tsx', 'ts', 'jsx', 'js'],\n  target: 'server',\n  poweredByHeader: true,\n  compress: true,\n  analyticsId: process.env.VERCEL_ANALYTICS_ID || '',\n  images: imageConfigDefault,\n  devIndicators: {\n    buildActivity: true,\n    buildActivityPosition: 'bottom-right',\n  },\n  onDemandEntries: {\n    maxInactiveAge: 15 * 1000,\n    pagesBufferLength: 2,\n  },\n  amp: {\n    canonicalBase: '',\n  },\n  basePath: '',\n  sassOptions: {},\n  trailingSlash: false,\n  i18n: null,\n  productionBrowserSourceMaps: false,\n  optimizeFonts: true,\n  webpack5: undefined,\n  excludeDefaultMomentLocales: true,\n  serverRuntimeConfig: {},\n  publicRuntimeConfig: {},\n  reactStrictMode: false,\n  httpAgentOptions: {\n    keepAlive: true,\n  },\n  outputFileTracing: true,\n  staticPageGenerationTimeout: 60,\n  swcMinify: false,\n  experimental: {\n    cpus: Math.max(\n      1,\n      (Number(process.env.CIRCLE_NODE_TOTAL) ||\n        (os.cpus() || { length: 1 }).length) - 1\n    ),\n    sharedPool: true,\n    plugins: false,\n    profiling: false,\n    isrFlushToDisk: true,\n    workerThreads: false,\n    pageEnv: false,\n    optimizeImages: false,\n    optimizeCss: false,\n    scrollRestoration: false,\n    externalDir: false,\n    reactRoot: Number(process.env.NEXT_PRIVATE_REACT_ROOT) > 0,\n    disableOptimizedLoading: false,\n    gzipSize: true,\n    swcFileReading: true,\n    craCompat: false,\n    esmExternals: true,\n    // default to 50MB limit\n    isrMemoryCacheSize: 50 * 1024 * 1024,\n    concurrentFeatures: false,\n    serverComponents: false,\n    fullySpecified: false,\n    outputFileTracingRoot: process.env.NEXT_PRIVATE_OUTPUT_TRACE_ROOT || '',\n    outputStandalone: !!process.env.NEXT_PRIVATE_STANDALONE,\n  },\n}\n\nexport async function normalizeConfig(phase: string, config: any) {\n  if (typeof config === 'function') {\n    config = config(phase, { defaultConfig })\n  }\n  // Support `new Promise` and `async () =>` as return values of the config export\n  return await config\n}\n"],"names":["normalizeConfig","defaultConfig","env","webpack","webpackDevMiddleware","eslint","ignoreDuringBuilds","typescript","ignoreBuildErrors","tsconfigPath","distDir","cleanDistDir","assetPrefix","configOrigin","useFileSystemPublicRoutes","generateBuildId","generateEtags","pageExtensions","target","poweredByHeader","compress","analyticsId","process","VERCEL_ANALYTICS_ID","images","devIndicators","buildActivity","buildActivityPosition","onDemandEntries","maxInactiveAge","pagesBufferLength","amp","canonicalBase","basePath","sassOptions","trailingSlash","i18n","productionBrowserSourceMaps","optimizeFonts","webpack5","undefined","excludeDefaultMomentLocales","serverRuntimeConfig","publicRuntimeConfig","reactStrictMode","httpAgentOptions","keepAlive","outputFileTracing","staticPageGenerationTimeout","swcMinify","experimental","cpus","Math","max","Number","CIRCLE_NODE_TOTAL","length","sharedPool","plugins","profiling","isrFlushToDisk","workerThreads","pageEnv","optimizeImages","optimizeCss","scrollRestoration","externalDir","reactRoot","NEXT_PRIVATE_REACT_ROOT","disableOptimizedLoading","gzipSize","swcFileReading","craCompat","esmExternals","isrMemoryCacheSize","concurrentFeatures","serverComponents","fullySpecified","outputFileTracingRoot","NEXT_PRIVATE_OUTPUT_TRACE_ROOT","outputStandalone","NEXT_PRIVATE_STANDALONE","phase","config"],"mappings":";;;;QAodsBA,eAAe,GAAfA,eAAe;;AApdtB,GAAI,CAAJ,GAAI;AAOZ,GAAgB,CAAhB,YAAgB;;;;;;AAyXhB,KAAK,CAACC,aAAa,GAAe,CAAC;IACxCC,GAAG,EAAE,CAAC,CAAC;IACPC,OAAO,EAAE,IAAI;IACbC,oBAAoB,EAAE,IAAI;IAC1BC,MAAM,EAAE,CAAC;QACPC,kBAAkB,EAAE,KAAK;IAC3B,CAAC;IACDC,UAAU,EAAE,CAAC;QACXC,iBAAiB,EAAE,KAAK;QACxBC,YAAY,EAAE,CAAe;IAC/B,CAAC;IACDC,OAAO,EAAE,CAAO;IAChBC,YAAY,EAAE,IAAI;IAClBC,WAAW,EAAE,CAAE;IACfC,YAAY,EAAE,CAAS;IACvBC,yBAAyB,EAAE,IAAI;IAC/BC,eAAe,MAAQ,IAAI;;IAC3BC,aAAa,EAAE,IAAI;IACnBC,cAAc,EAAE,CAAC;QAAA,CAAK;QAAE,CAAI;QAAE,CAAK;QAAE,CAAI;IAAA,CAAC;IAC1CC,MAAM,EAAE,CAAQ;IAChBC,eAAe,EAAE,IAAI;IACrBC,QAAQ,EAAE,IAAI;IACdC,WAAW,EAAEC,OAAO,CAACpB,GAAG,CAACqB,mBAAmB,IAAI,CAAE;IAClDC,MAAM,EAhZD,YAAgB;IAiZrBC,aAAa,EAAE,CAAC;QACdC,aAAa,EAAE,IAAI;QACnBC,qBAAqB,EAAE,CAAc;IACvC,CAAC;IACDC,eAAe,EAAE,CAAC;QAChBC,cAAc,EAAE,EAAE,GAAG,IAAI;QACzBC,iBAAiB,EAAE,CAAC;IACtB,CAAC;IACDC,GAAG,EAAE,CAAC;QACJC,aAAa,EAAE,CAAE;IACnB,CAAC;IACDC,QAAQ,EAAE,CAAE;IACZC,WAAW,EAAE,CAAC,CAAC;IACfC,aAAa,EAAE,KAAK;IACpBC,IAAI,EAAE,IAAI;IACVC,2BAA2B,EAAE,KAAK;IAClCC,aAAa,EAAE,IAAI;IACnBC,QAAQ,EAAEC,SAAS;IACnBC,2BAA2B,EAAE,IAAI;IACjCC,mBAAmB,EAAE,CAAC,CAAC;IACvBC,mBAAmB,EAAE,CAAC,CAAC;IACvBC,eAAe,EAAE,KAAK;IACtBC,gBAAgB,EAAE,CAAC;QACjBC,SAAS,EAAE,IAAI;IACjB,CAAC;IACDC,iBAAiB,EAAE,IAAI;IACvBC,2BAA2B,EAAE,EAAE;IAC/BC,SAAS,EAAE,KAAK;IAChBC,YAAY,EAAE,CAAC;QACbC,IAAI,EAAEC,IAAI,CAACC,GAAG,CACZ,CAAC,GACAC,MAAM,CAAChC,OAAO,CAACpB,GAAG,CAACqD,iBAAiB,MAvb5B,GAAI,SAwbPJ,IAAI,MAAM,CAAC;YAACK,MAAM,EAAE,CAAC;QAAC,CAAC,EAAEA,MAAM,IAAI,CAAC;QAE5CC,UAAU,EAAE,IAAI;QAChBC,OAAO,EAAE,KAAK;QACdC,SAAS,EAAE,KAAK;QAChBC,cAAc,EAAE,IAAI;QACpBC,aAAa,EAAE,KAAK;QACpBC,OAAO,EAAE,KAAK;QACdC,cAAc,EAAE,KAAK;QACrBC,WAAW,EAAE,KAAK;QAClBC,iBAAiB,EAAE,KAAK;QACxBC,WAAW,EAAE,KAAK;QAClBC,SAAS,EAAEb,MAAM,CAAChC,OAAO,CAACpB,GAAG,CAACkE,uBAAuB,IAAI,CAAC;QAC1DC,uBAAuB,EAAE,KAAK;QAC9BC,QAAQ,EAAE,IAAI;QACdC,cAAc,EAAE,IAAI;QACpBC,SAAS,EAAE,KAAK;QAChBC,YAAY,EAAE,IAAI;QAClB,EAAwB,AAAxB,sBAAwB;QACxBC,kBAAkB,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI;QACpCC,kBAAkB,EAAE,KAAK;QACzBC,gBAAgB,EAAE,KAAK;QACvBC,cAAc,EAAE,KAAK;QACrBC,qBAAqB,EAAExD,OAAO,CAACpB,GAAG,CAAC6E,8BAA8B,IAAI,CAAE;QACvEC,gBAAgB,IAAI1D,OAAO,CAACpB,GAAG,CAAC+E,uBAAuB;IACzD,CAAC;AACH,CAAC;QAlFYhF,aAAa,GAAbA,aAAa;eAoFJD,eAAe,CAACkF,KAAa,EAAEC,MAAW,EAAE,CAAC;IACjE,EAAE,EAAE,MAAM,CAACA,MAAM,KAAK,CAAU,WAAE,CAAC;QACjCA,MAAM,GAAGA,MAAM,CAACD,KAAK,EAAE,CAAC;YAACjF,aAAa;QAAC,CAAC;IAC1C,CAAC;IACD,EAAgF,AAAhF,8EAAgF;IAChF,MAAM,CAAC,KAAK,CAACkF,MAAM;AACrB,CAAC"}