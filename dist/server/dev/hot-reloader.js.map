{"version":3,"sources":["../../../server/dev/hot-reloader.ts"],"sourcesContent":["import { getOverlayMiddleware } from 'next/dist/compiled/@next/react-dev-overlay/middleware'\nimport { IncomingMessage, ServerResponse } from 'http'\nimport { WebpackHotMiddleware } from './hot-middleware'\nimport { join, relative, isAbsolute } from 'path'\nimport { UrlObject } from 'url'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\nimport type { webpack5 } from 'next/dist/compiled/webpack/webpack'\nimport {\n  createEntrypoints,\n  createPagesMapping,\n  finalizeEntrypoint,\n  PagesMapping,\n} from '../../build/entries'\nimport { watchCompilers } from '../../build/output'\nimport getBaseWebpackConfig from '../../build/webpack-config'\nimport { API_ROUTE, MIDDLEWARE_ROUTE } from '../../lib/constants'\nimport { recursiveDelete } from '../../lib/recursive-delete'\nimport { BLOCKED_PAGES } from '../../shared/lib/constants'\nimport { __ApiPreviewProps } from '../api-utils'\nimport { route } from '../router'\nimport { findPageFile } from '../lib/find-page-file'\nimport onDemandEntryHandler, {\n  entries,\n  BUILDING,\n} from './on-demand-entry-handler'\nimport { denormalizePagePath, normalizePathSep } from '../normalize-page-path'\nimport getRouteFromEntrypoint from '../get-route-from-entrypoint'\nimport { fileExists } from '../../lib/file-exists'\nimport { ClientPagesLoaderOptions } from '../../build/webpack/loaders/next-client-pages-loader'\nimport { ssrEntries } from '../../build/webpack/plugins/middleware-plugin'\nimport { stringify } from 'querystring'\nimport {\n  difference,\n  isCustomErrorPage,\n  isFlightPage,\n  isReservedPage,\n} from '../../build/utils'\nimport { NextConfigComplete } from '../config-shared'\nimport { CustomRoutes } from '../../lib/load-custom-routes'\nimport { DecodeError } from '../../shared/lib/utils'\nimport { Span, trace } from '../../trace'\nimport { getProperError } from '../../lib/is-error'\nimport ws from 'next/dist/compiled/ws'\n\nconst wsServer = new ws.Server({ noServer: true })\n\nexport async function renderScriptError(\n  res: ServerResponse,\n  error: Error,\n  { verbose = true } = {}\n) {\n  // Asks CDNs and others to not to cache the errored page\n  res.setHeader(\n    'Cache-Control',\n    'no-cache, no-store, max-age=0, must-revalidate'\n  )\n\n  if ((error as any).code === 'ENOENT') {\n    res.statusCode = 404\n    res.end('404 - Not Found')\n    return\n  }\n\n  if (verbose) {\n    console.error(error.stack)\n  }\n  res.statusCode = 500\n  res.end('500 - Internal Error')\n}\n\nfunction addCorsSupport(req: IncomingMessage, res: ServerResponse) {\n  const isApiRoute = req.url!.match(API_ROUTE)\n  // API routes handle their own CORS headers\n  if (isApiRoute) {\n    return { preflight: false }\n  }\n\n  if (!req.headers.origin) {\n    return { preflight: false }\n  }\n\n  res.setHeader('Access-Control-Allow-Origin', req.headers.origin)\n  res.setHeader('Access-Control-Allow-Methods', 'OPTIONS, GET')\n  // Based on https://github.com/primus/access-control/blob/4cf1bc0e54b086c91e6aa44fb14966fa5ef7549c/index.js#L158\n  if (req.headers['access-control-request-headers']) {\n    res.setHeader(\n      'Access-Control-Allow-Headers',\n      req.headers['access-control-request-headers'] as string\n    )\n  }\n\n  if (req.method === 'OPTIONS') {\n    res.writeHead(200)\n    res.end()\n    return { preflight: true }\n  }\n\n  return { preflight: false }\n}\n\nconst matchNextPageBundleRequest = route(\n  '/_next/static/chunks/pages/:path*.js(\\\\.map|)'\n)\n\n// Recursively look up the issuer till it ends up at the root\nfunction findEntryModule(issuer: any): any {\n  if (issuer.issuer) {\n    return findEntryModule(issuer.issuer)\n  }\n\n  return issuer\n}\n\nfunction erroredPages(compilation: webpack5.Compilation) {\n  const failedPages: { [page: string]: any[] } = {}\n  for (const error of compilation.errors) {\n    if (!error.module) {\n      continue\n    }\n\n    const entryModule = findEntryModule(error.module)\n    const { name } = entryModule\n    if (!name) {\n      continue\n    }\n\n    // Only pages have to be reloaded\n    const enhancedName = getRouteFromEntrypoint(name)\n\n    if (!enhancedName) {\n      continue\n    }\n\n    if (!failedPages[enhancedName]) {\n      failedPages[enhancedName] = []\n    }\n\n    failedPages[enhancedName].push(error)\n  }\n\n  return failedPages\n}\n\nexport default class HotReloader {\n  private dir: string\n  private buildId: string\n  private middlewares: any[]\n  private pagesDir: string\n  private webpackHotMiddleware?: WebpackHotMiddleware\n  private config: NextConfigComplete\n  private webServerRuntime: boolean\n  private hasServerComponents: boolean\n  public clientStats: webpack5.Stats | null\n  public serverStats: webpack5.Stats | null\n  private clientError: Error | null = null\n  private serverError: Error | null = null\n  private serverPrevDocumentHash: string | null\n  private prevChunkNames?: Set<any>\n  private onDemandEntries?: ReturnType<typeof onDemandEntryHandler>\n  private previewProps: __ApiPreviewProps\n  private watcher: any\n  private rewrites: CustomRoutes['rewrites']\n  private fallbackWatcher: any\n  private hotReloaderSpan: Span\n  private pagesMapping: PagesMapping = {}\n\n  constructor(\n    dir: string,\n    {\n      config,\n      pagesDir,\n      buildId,\n      previewProps,\n      rewrites,\n    }: {\n      config: NextConfigComplete\n      pagesDir: string\n      buildId: string\n      previewProps: __ApiPreviewProps\n      rewrites: CustomRoutes['rewrites']\n    }\n  ) {\n    this.buildId = buildId\n    this.dir = dir\n    this.middlewares = []\n    this.pagesDir = pagesDir\n    this.clientStats = null\n    this.serverStats = null\n    this.serverPrevDocumentHash = null\n\n    this.config = config\n    this.webServerRuntime = !!config.experimental.concurrentFeatures\n    this.hasServerComponents = !!(\n      config.experimental.concurrentFeatures &&\n      config.experimental.serverComponents\n    )\n    this.previewProps = previewProps\n    this.rewrites = rewrites\n    this.hotReloaderSpan = trace('hot-reloader', undefined, {\n      version: process.env.__NEXT_VERSION as string,\n    })\n    // Ensure the hotReloaderSpan is flushed immediately as it's the parentSpan for all processing\n    // of the current `next dev` invocation.\n    this.hotReloaderSpan.stop()\n  }\n\n  public async run(\n    req: IncomingMessage,\n    res: ServerResponse,\n    parsedUrl: UrlObject\n  ): Promise<{ finished?: true }> {\n    // Usually CORS support is not needed for the hot-reloader (this is dev only feature)\n    // With when the app runs for multi-zones support behind a proxy,\n    // the current page is trying to access this URL via assetPrefix.\n    // That's when the CORS support is needed.\n    const { preflight } = addCorsSupport(req, res)\n    if (preflight) {\n      return {}\n    }\n\n    // When a request comes in that is a page bundle, e.g. /_next/static/<buildid>/pages/index.js\n    // we have to compile the page using on-demand-entries, this middleware will handle doing that\n    // by adding the page to on-demand-entries, waiting till it's done\n    // and then the bundle will be served like usual by the actual route in server/index.js\n    const handlePageBundleRequest = async (\n      pageBundleRes: ServerResponse,\n      parsedPageBundleUrl: UrlObject\n    ): Promise<{ finished?: true }> => {\n      const { pathname } = parsedPageBundleUrl\n      const params: { path: string[] } | null =\n        matchNextPageBundleRequest(pathname)\n      if (!params) {\n        return {}\n      }\n\n      let decodedPagePath: string\n\n      try {\n        decodedPagePath = `/${params.path\n          .map((param) => decodeURIComponent(param))\n          .join('/')}`\n      } catch (_) {\n        throw new DecodeError('failed to decode param')\n      }\n\n      const page = denormalizePagePath(decodedPagePath)\n\n      if (page === '/_error' || BLOCKED_PAGES.indexOf(page) === -1) {\n        try {\n          await this.ensurePage(page, true)\n        } catch (error) {\n          await renderScriptError(pageBundleRes, getProperError(error))\n          return { finished: true }\n        }\n\n        const errors = await this.getCompilationErrors(page)\n        if (errors.length > 0) {\n          await renderScriptError(pageBundleRes, errors[0], { verbose: false })\n          return { finished: true }\n        }\n      }\n\n      return {}\n    }\n\n    const { finished } = await handlePageBundleRequest(res, parsedUrl)\n\n    for (const fn of this.middlewares) {\n      await new Promise<void>((resolve, reject) => {\n        fn(req, res, (err: Error) => {\n          if (err) return reject(err)\n          resolve()\n        })\n      })\n    }\n\n    return { finished }\n  }\n\n  public onHMR(req: IncomingMessage, _res: ServerResponse, head: Buffer) {\n    wsServer.handleUpgrade(req, req.socket, head, (client) => {\n      this.webpackHotMiddleware?.onHMR(client)\n      this.onDemandEntries?.onHMR(client)\n    })\n  }\n\n  private async clean(span: Span): Promise<void> {\n    return span\n      .traceChild('clean')\n      .traceAsyncFn(() =>\n        recursiveDelete(join(this.dir, this.config.distDir), /^cache/)\n      )\n  }\n\n  private async getWebpackConfig(span: Span) {\n    const webpackConfigSpan = span.traceChild('get-webpack-config')\n\n    return webpackConfigSpan.traceAsyncFn(async () => {\n      const pagePaths = await webpackConfigSpan\n        .traceChild('get-page-paths')\n        .traceAsyncFn(() =>\n          Promise.all([\n            findPageFile(this.pagesDir, '/_app', this.config.pageExtensions),\n            findPageFile(\n              this.pagesDir,\n              '/_document',\n              this.config.pageExtensions\n            ),\n          ])\n        )\n\n      this.pagesMapping = webpackConfigSpan\n        .traceChild('create-pages-mapping')\n        .traceFn(() =>\n          createPagesMapping(\n            pagePaths.filter((i) => i !== null) as string[],\n            this.config.pageExtensions,\n            {\n              isDev: true,\n              hasConcurrentFeatures: this.webServerRuntime,\n              hasServerComponents: this.hasServerComponents,\n            }\n          )\n        )\n\n      const entrypoints = webpackConfigSpan\n        .traceChild('create-entrypoints')\n        .traceFn(() =>\n          createEntrypoints(\n            this.pagesMapping,\n            'server',\n            this.buildId,\n            this.previewProps,\n            this.config,\n            []\n          )\n        )\n\n      return webpackConfigSpan\n        .traceChild('generate-webpack-config')\n        .traceAsyncFn(() =>\n          Promise.all(\n            [\n              getBaseWebpackConfig(this.dir, {\n                dev: true,\n                isServer: false,\n                config: this.config,\n                buildId: this.buildId,\n                pagesDir: this.pagesDir,\n                rewrites: this.rewrites,\n                entrypoints: entrypoints.client,\n                runWebpackSpan: this.hotReloaderSpan,\n              }),\n              getBaseWebpackConfig(this.dir, {\n                dev: true,\n                isServer: true,\n                config: this.config,\n                buildId: this.buildId,\n                pagesDir: this.pagesDir,\n                rewrites: this.rewrites,\n                entrypoints: entrypoints.server,\n                runWebpackSpan: this.hotReloaderSpan,\n              }),\n              this.webServerRuntime\n                ? getBaseWebpackConfig(this.dir, {\n                    dev: true,\n                    isServer: true,\n                    webServerRuntime: true,\n                    config: this.config,\n                    buildId: this.buildId,\n                    pagesDir: this.pagesDir,\n                    rewrites: this.rewrites,\n                    entrypoints: entrypoints.serverWeb,\n                    runWebpackSpan: this.hotReloaderSpan,\n                  })\n                : null,\n            ].filter(Boolean) as webpack.Configuration[]\n          )\n        )\n    })\n  }\n\n  public async buildFallbackError(): Promise<void> {\n    if (this.fallbackWatcher) return\n\n    const fallbackConfig = await getBaseWebpackConfig(this.dir, {\n      runWebpackSpan: this.hotReloaderSpan,\n      dev: true,\n      isServer: false,\n      config: this.config,\n      buildId: this.buildId,\n      pagesDir: this.pagesDir,\n      rewrites: {\n        beforeFiles: [],\n        afterFiles: [],\n        fallback: [],\n      },\n      isDevFallback: true,\n      entrypoints: createEntrypoints(\n        {\n          '/_app': 'next/dist/pages/_app',\n          '/_error': 'next/dist/pages/_error',\n        },\n        'server',\n        this.buildId,\n        this.previewProps,\n        this.config,\n        []\n      ).client,\n    })\n    const fallbackCompiler = webpack(fallbackConfig)\n\n    this.fallbackWatcher = await new Promise((resolve) => {\n      let bootedFallbackCompiler = false\n      fallbackCompiler.watch(\n        // @ts-ignore webpack supports an array of watchOptions when using a multiCompiler\n        fallbackConfig.watchOptions,\n        // Errors are handled separately\n        (_err: any) => {\n          if (!bootedFallbackCompiler) {\n            bootedFallbackCompiler = true\n            resolve(true)\n          }\n        }\n      )\n    })\n  }\n\n  public async start(): Promise<void> {\n    const startSpan = this.hotReloaderSpan.traceChild('start')\n    startSpan.stop() // Stop immediately to create an artificial parent span\n\n    await this.clean(startSpan)\n\n    const configs = await this.getWebpackConfig(startSpan)\n\n    for (const config of configs) {\n      const defaultEntry = config.entry\n      config.entry = async (...args) => {\n        // @ts-ignore entry is always a function\n        const entrypoints = await defaultEntry(...args)\n        const isClientCompilation = config.name === 'client'\n        const isServerCompilation = config.name === 'server'\n        const isServerWebCompilation = config.name === 'server-web'\n\n        await Promise.all(\n          Object.keys(entries).map(async (pageKey) => {\n            const isClientKey = pageKey.startsWith('client')\n            const isServerWebKey = pageKey.startsWith('server-web')\n            if (isClientKey !== isClientCompilation) return\n            if (isServerWebKey !== isServerWebCompilation) return\n            const page = pageKey.slice(\n              isClientKey\n                ? 'client'.length\n                : isServerWebKey\n                ? 'server-web'.length\n                : 'server'.length\n            )\n            const isMiddleware = !!page.match(MIDDLEWARE_ROUTE)\n\n            if (isClientCompilation && page.match(API_ROUTE) && !isMiddleware) {\n              return\n            }\n\n            const isApiRoute = page.match(API_ROUTE)\n\n            if (!isClientCompilation && isMiddleware) {\n              return\n            }\n\n            const { bundlePath, absolutePagePath, dispose } = entries[pageKey]\n            const pageExists = !dispose && (await fileExists(absolutePagePath))\n            if (!pageExists) {\n              // page was removed or disposed\n              delete entries[pageKey]\n              return\n            }\n\n            const isCustomError = isCustomErrorPage(page)\n            const isReserved = isReservedPage(page)\n            const isServerComponent =\n              this.hasServerComponents &&\n              isFlightPage(this.config, absolutePagePath)\n\n            if (\n              isServerCompilation &&\n              this.webServerRuntime &&\n              !isApiRoute &&\n              !isCustomError\n            ) {\n              return\n            }\n\n            entries[pageKey].status = BUILDING\n            const pageLoaderOpts: ClientPagesLoaderOptions = {\n              page,\n              absolutePagePath,\n            }\n\n            if (isClientCompilation && isMiddleware) {\n              entrypoints[bundlePath] = finalizeEntrypoint({\n                name: bundlePath,\n                value: `next-middleware-loader?${stringify(pageLoaderOpts)}!`,\n                isServer: false,\n                isMiddleware: true,\n              })\n            } else if (isClientCompilation) {\n              entrypoints[bundlePath] = finalizeEntrypoint({\n                name: bundlePath,\n                value: `next-client-pages-loader?${stringify(pageLoaderOpts)}!`,\n                isServer: false,\n              })\n\n              if (isServerComponent) {\n                ssrEntries.set(bundlePath, { requireFlightManifest: true })\n              } else if (\n                this.webServerRuntime &&\n                !isReserved &&\n                !isCustomError\n              ) {\n                ssrEntries.set(bundlePath, { requireFlightManifest: false })\n              }\n            } else if (isServerWebCompilation) {\n              if (!isReserved) {\n                entrypoints[bundlePath] = finalizeEntrypoint({\n                  name: '[name].js',\n                  value: `next-middleware-ssr-loader?${stringify({\n                    dev: true,\n                    page,\n                    stringifiedConfig: JSON.stringify(this.config),\n                    absoluteAppPath: this.pagesMapping['/_app'],\n                    absoluteDocumentPath: this.pagesMapping['/_document'],\n                    absoluteErrorPath: this.pagesMapping['/_error'],\n                    absolute404Path: this.pagesMapping['/404'] || '',\n                    absolutePagePath,\n                    isServerComponent,\n                    buildId: this.buildId,\n                  } as any)}!`,\n                  isServer: false,\n                  isServerWeb: true,\n                })\n              }\n            } else {\n              let request = relative(config.context!, absolutePagePath)\n              if (!isAbsolute(request) && !request.startsWith('../')) {\n                request = `./${request}`\n              }\n\n              entrypoints[bundlePath] = finalizeEntrypoint({\n                name: bundlePath,\n                value: request,\n                isServer: true,\n              })\n            }\n          })\n        )\n\n        return entrypoints\n      }\n    }\n\n    // Enable building of client compilation before server compilation in development\n    // @ts-ignore webpack 5\n    configs.parallelism = 1\n\n    const multiCompiler = webpack(configs) as unknown as webpack5.MultiCompiler\n\n    watchCompilers(\n      multiCompiler.compilers[0],\n      multiCompiler.compilers[1],\n      multiCompiler.compilers[2] || null\n    )\n\n    // Watch for changes to client/server page files so we can tell when just\n    // the server file changes and trigger a reload for GS(S)P pages\n    const changedClientPages = new Set<string>()\n    const changedServerPages = new Set<string>()\n    const prevClientPageHashes = new Map<string, string>()\n    const prevServerPageHashes = new Map<string, string>()\n\n    const trackPageChanges =\n      (pageHashMap: Map<string, string>, changedItems: Set<string>) =>\n      (stats: webpack5.Compilation) => {\n        stats.entrypoints.forEach((entry, key) => {\n          if (key.startsWith('pages/')) {\n            // TODO this doesn't handle on demand loaded chunks\n            entry.chunks.forEach((chunk: any) => {\n              if (chunk.id === key) {\n                const prevHash = pageHashMap.get(key)\n\n                if (prevHash && prevHash !== chunk.hash) {\n                  changedItems.add(key)\n                }\n                pageHashMap.set(key, chunk.hash)\n              }\n            })\n          }\n        })\n      }\n\n    multiCompiler.compilers[0].hooks.emit.tap(\n      'NextjsHotReloaderForClient',\n      trackPageChanges(prevClientPageHashes, changedClientPages)\n    )\n    multiCompiler.compilers[1].hooks.emit.tap(\n      'NextjsHotReloaderForServer',\n      trackPageChanges(prevServerPageHashes, changedServerPages)\n    )\n\n    // This plugin watches for changes to _document.js and notifies the client side that it should reload the page\n    multiCompiler.compilers[1].hooks.failed.tap(\n      'NextjsHotReloaderForServer',\n      (err: Error) => {\n        this.serverError = err\n        this.serverStats = null\n      }\n    )\n    multiCompiler.compilers[1].hooks.done.tap(\n      'NextjsHotReloaderForServer',\n      (stats) => {\n        this.serverError = null\n        this.serverStats = stats\n\n        const { compilation } = stats\n\n        // We only watch `_document` for changes on the server compilation\n        // the rest of the files will be triggered by the client compilation\n        const documentChunk = compilation.namedChunks.get('pages/_document')\n        // If the document chunk can't be found we do nothing\n        if (!documentChunk) {\n          console.warn('_document.js chunk not found')\n          return\n        }\n\n        // Initial value\n        if (this.serverPrevDocumentHash === null) {\n          this.serverPrevDocumentHash = documentChunk.hash || null\n          return\n        }\n\n        // If _document.js didn't change we don't trigger a reload\n        if (documentChunk.hash === this.serverPrevDocumentHash) {\n          return\n        }\n\n        // Notify reload to reload the page, as _document.js was changed (different hash)\n        this.send('reloadPage')\n        this.serverPrevDocumentHash = documentChunk.hash || null\n      }\n    )\n    multiCompiler.hooks.done.tap('NextjsHotReloaderForServer', () => {\n      const serverOnlyChanges = difference<string>(\n        changedServerPages,\n        changedClientPages\n      )\n      const middlewareChanges = Array.from(changedClientPages).filter((name) =>\n        name.match(MIDDLEWARE_ROUTE)\n      )\n      changedClientPages.clear()\n      changedServerPages.clear()\n\n      if (middlewareChanges.length > 0) {\n        this.send({\n          event: 'middlewareChanges',\n        })\n      }\n      if (serverOnlyChanges.length > 0) {\n        this.send({\n          event: 'serverOnlyChanges',\n          pages: serverOnlyChanges.map((pg) =>\n            denormalizePagePath(pg.substr('pages'.length))\n          ),\n        })\n      }\n    })\n\n    multiCompiler.compilers[0].hooks.failed.tap(\n      'NextjsHotReloaderForClient',\n      (err: Error) => {\n        this.clientError = err\n        this.clientStats = null\n      }\n    )\n    multiCompiler.compilers[0].hooks.done.tap(\n      'NextjsHotReloaderForClient',\n      (stats) => {\n        this.clientError = null\n        this.clientStats = stats\n\n        const { compilation } = stats\n        const chunkNames = new Set(\n          [...compilation.namedChunks.keys()].filter(\n            (name) => !!getRouteFromEntrypoint(name)\n          )\n        )\n\n        if (this.prevChunkNames) {\n          // detect chunks which have to be replaced with a new template\n          // e.g, pages/index.js <-> pages/_error.js\n          const addedPages = diff(chunkNames, this.prevChunkNames!)\n          const removedPages = diff(this.prevChunkNames!, chunkNames)\n\n          if (addedPages.size > 0) {\n            for (const addedPage of addedPages) {\n              const page = getRouteFromEntrypoint(addedPage)\n              this.send('addedPage', page)\n            }\n          }\n\n          if (removedPages.size > 0) {\n            for (const removedPage of removedPages) {\n              const page = getRouteFromEntrypoint(removedPage)\n              this.send('removedPage', page)\n            }\n          }\n        }\n\n        this.prevChunkNames = chunkNames\n      }\n    )\n\n    this.webpackHotMiddleware = new WebpackHotMiddleware(\n      multiCompiler.compilers\n    )\n\n    let booted = false\n\n    this.watcher = await new Promise((resolve) => {\n      const watcher = multiCompiler.watch(\n        // @ts-ignore webpack supports an array of watchOptions when using a multiCompiler\n        configs.map((config) => config.watchOptions!),\n        // Errors are handled separately\n        (_err: any) => {\n          if (!booted) {\n            booted = true\n            resolve(watcher)\n          }\n        }\n      )\n    })\n\n    this.onDemandEntries = onDemandEntryHandler(this.watcher, multiCompiler, {\n      pagesDir: this.pagesDir,\n      nextConfig: this.config,\n      ...(this.config.onDemandEntries as {\n        maxInactiveAge: number\n        pagesBufferLength: number\n      }),\n    })\n\n    this.middlewares = [\n      getOverlayMiddleware({\n        rootDirectory: this.dir,\n        stats: () => this.clientStats,\n        serverStats: () => this.serverStats,\n      }),\n    ]\n  }\n\n  public async stop(): Promise<void> {\n    await new Promise((resolve, reject) => {\n      this.watcher.close((err: any) => (err ? reject(err) : resolve(true)))\n    })\n\n    if (this.fallbackWatcher) {\n      await new Promise((resolve, reject) => {\n        this.fallbackWatcher.close((err: any) =>\n          err ? reject(err) : resolve(true)\n        )\n      })\n    }\n  }\n\n  public async getCompilationErrors(page: string) {\n    const normalizedPage = normalizePathSep(page)\n\n    if (this.clientError || this.serverError) {\n      return [this.clientError || this.serverError]\n    } else if (this.clientStats?.hasErrors()) {\n      const { compilation } = this.clientStats\n      const failedPages = erroredPages(compilation)\n\n      // If there is an error related to the requesting page we display it instead of the first error\n      if (\n        failedPages[normalizedPage] &&\n        failedPages[normalizedPage].length > 0\n      ) {\n        return failedPages[normalizedPage]\n      }\n\n      // If none were found we still have to show the other errors\n      return this.clientStats.compilation.errors\n    } else if (this.serverStats?.hasErrors()) {\n      const { compilation } = this.serverStats\n      const failedPages = erroredPages(compilation)\n\n      // If there is an error related to the requesting page we display it instead of the first error\n      if (\n        failedPages[normalizedPage] &&\n        failedPages[normalizedPage].length > 0\n      ) {\n        return failedPages[normalizedPage]\n      }\n\n      // If none were found we still have to show the other errors\n      return this.serverStats.compilation.errors\n    }\n\n    return []\n  }\n\n  public send(action?: string | any, ...args: any[]): void {\n    this.webpackHotMiddleware!.publish(\n      action && typeof action === 'object' ? action : { action, data: args }\n    )\n  }\n\n  public async ensurePage(page: string, clientOnly: boolean = false) {\n    // Make sure we don't re-build or dispose prebuilt pages\n    if (page !== '/_error' && BLOCKED_PAGES.indexOf(page) !== -1) {\n      return\n    }\n    const error = clientOnly\n      ? this.clientError\n      : this.serverError || this.clientError\n    if (error) {\n      return Promise.reject(error)\n    }\n    return this.onDemandEntries?.ensurePage(page, clientOnly) as any\n  }\n}\n\nfunction diff(a: Set<any>, b: Set<any>) {\n  return new Set([...a].filter((v) => !b.has(v)))\n}\n"],"names":["renderScriptError","wsServer","Server","noServer","res","error","verbose","setHeader","code","statusCode","end","console","stack","addCorsSupport","req","isApiRoute","url","match","preflight","headers","origin","method","writeHead","matchNextPageBundleRequest","findEntryModule","issuer","erroredPages","compilation","failedPages","errors","module","entryModule","name","enhancedName","push","HotReloader","dir","config","pagesDir","buildId","previewProps","rewrites","clientError","serverError","pagesMapping","middlewares","clientStats","serverStats","serverPrevDocumentHash","webServerRuntime","experimental","concurrentFeatures","hasServerComponents","serverComponents","hotReloaderSpan","undefined","version","process","env","__NEXT_VERSION","stop","run","parsedUrl","handlePageBundleRequest","pageBundleRes","parsedPageBundleUrl","pathname","params","decodedPagePath","path","map","param","decodeURIComponent","join","_","page","indexOf","ensurePage","finished","getCompilationErrors","length","fn","Promise","resolve","reject","err","onHMR","_res","head","handleUpgrade","socket","client","webpackHotMiddleware","onDemandEntries","clean","span","traceChild","traceAsyncFn","distDir","getWebpackConfig","webpackConfigSpan","pagePaths","all","pageExtensions","traceFn","filter","i","isDev","hasConcurrentFeatures","entrypoints","dev","isServer","runWebpackSpan","server","serverWeb","Boolean","buildFallbackError","fallbackWatcher","fallbackConfig","beforeFiles","afterFiles","fallback","isDevFallback","fallbackCompiler","bootedFallbackCompiler","watch","watchOptions","_err","start","startSpan","configs","defaultEntry","entry","args","isClientCompilation","isServerCompilation","isServerWebCompilation","Object","keys","pageKey","isClientKey","startsWith","isServerWebKey","slice","isMiddleware","bundlePath","absolutePagePath","dispose","pageExists","isCustomError","isReserved","isServerComponent","status","pageLoaderOpts","value","set","requireFlightManifest","stringifiedConfig","JSON","stringify","absoluteAppPath","absoluteDocumentPath","absoluteErrorPath","absolute404Path","isServerWeb","request","context","parallelism","multiCompiler","compilers","changedClientPages","Set","changedServerPages","prevClientPageHashes","Map","prevServerPageHashes","trackPageChanges","pageHashMap","changedItems","stats","forEach","key","chunks","chunk","id","prevHash","get","hash","add","hooks","emit","tap","failed","done","documentChunk","namedChunks","warn","send","serverOnlyChanges","middlewareChanges","Array","from","clear","event","pages","pg","substr","chunkNames","prevChunkNames","addedPages","diff","removedPages","size","addedPage","removedPage","booted","watcher","nextConfig","rootDirectory","close","normalizedPage","hasErrors","action","publish","data","clientOnly","a","b","v","has"],"mappings":"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"}