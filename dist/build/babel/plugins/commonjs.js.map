{"version":3,"sources":["../../../../build/babel/plugins/commonjs.ts"],"sourcesContent":["import { NodePath, PluginObj, types } from 'next/dist/compiled/babel/core'\nimport commonjsPlugin from 'next/dist/compiled/babel/plugin-transform-modules-commonjs'\n\n// Handle module.exports in user code\nexport default function CommonJSModulePlugin(...args: any): PluginObj {\n  const commonjs = commonjsPlugin(...args)\n  return {\n    visitor: {\n      Program: {\n        exit(path: NodePath<types.Program>, state) {\n          let foundModuleExports = false\n          path.traverse({\n            MemberExpression(expressionPath: any) {\n              if (expressionPath.node.object.name !== 'module') return\n              if (expressionPath.node.property.name !== 'exports') return\n              foundModuleExports = true\n            },\n          })\n\n          if (!foundModuleExports) {\n            return\n          }\n\n          commonjs.visitor.Program.exit.call(this, path, state)\n        },\n      },\n    },\n  }\n}\n"],"names":["CommonJSModulePlugin","args","commonjs","visitor","Program","exit","path","state","foundModuleExports","traverse","MemberExpression","expressionPath","node","object","name","property","call"],"mappings":";;;;kBAIwBA,oBAAoB;AAHjB,GAA4D,CAA5D,+BAA4D;;;;;;SAG/DA,oBAAoB,IAAIC,IAAI,EAAkB,CAAC;IACrE,KAAK,CAACC,QAAQ,OAJW,+BAA4D,aAIlDD,IAAI;IACvC,MAAM,CAAC,CAAC;QACNE,OAAO,EAAE,CAAC;YACRC,OAAO,EAAE,CAAC;gBACRC,IAAI,EAACC,IAA6B,EAAEC,KAAK,EAAE,CAAC;oBAC1C,GAAG,CAACC,kBAAkB,GAAG,KAAK;oBAC9BF,IAAI,CAACG,QAAQ,CAAC,CAAC;wBACbC,gBAAgB,EAACC,cAAmB,EAAE,CAAC;4BACrC,EAAE,EAAEA,cAAc,CAACC,IAAI,CAACC,MAAM,CAACC,IAAI,KAAK,CAAQ,SAAE,MAAM;4BACxD,EAAE,EAAEH,cAAc,CAACC,IAAI,CAACG,QAAQ,CAACD,IAAI,KAAK,CAAS,UAAE,MAAM;4BAC3DN,kBAAkB,GAAG,IAAI;wBAC3B,CAAC;oBACH,CAAC;oBAED,EAAE,GAAGA,kBAAkB,EAAE,CAAC;wBACxB,MAAM;oBACR,CAAC;oBAEDN,QAAQ,CAACC,OAAO,CAACC,OAAO,CAACC,IAAI,CAACW,IAAI,CAAC,IAAI,EAAEV,IAAI,EAAEC,KAAK;gBACtD,CAAC;YACH,CAAC;QACH,CAAC;IACH,CAAC;AACH,CAAC"}