{"version":3,"sources":["../../../../build/babel/loader/get-config.ts"],"sourcesContent":["import { readFileSync } from 'fs'\nimport JSON5 from 'next/dist/compiled/json5'\n\nimport { createConfigItem, loadOptions } from 'next/dist/compiled/babel/core'\nimport loadConfig from 'next/dist/compiled/babel/core-lib-config'\n\nimport { NextBabelLoaderOptions, NextJsLoaderContext } from './types'\nimport { consumeIterator } from './util'\nimport * as Log from '../../output/log'\n\nconst nextDistPath =\n  /(next[\\\\/]dist[\\\\/]shared[\\\\/]lib)|(next[\\\\/]dist[\\\\/]client)|(next[\\\\/]dist[\\\\/]pages)/\n\n/**\n * The properties defined here are the conditions with which subsets of inputs\n * can be identified that are able to share a common Babel config.  For example,\n * in dev mode, different transforms must be applied to a source file depending\n * on whether you're compiling for the client or for the server - thus `isServer`\n * is germane.\n *\n * However, these characteristics need not protect against circumstances that\n * will not be encountered in Next.js.  For example, a source file may be\n * transformed differently depending on whether we're doing a production compile\n * or for HMR in dev mode.  However, those two circumstances will never be\n * encountered within the context of a single V8 context (and, thus, shared\n * cache).  Therefore, hasReactRefresh is _not_ germane to caching.\n *\n * NOTE: This approach does not support multiple `.babelrc` files in a\n * single project.  A per-cache-key config will be generated once and,\n * if `.babelrc` is present, that config will be used for any subsequent\n * transformations.\n */\ninterface CharacteristicsGermaneToCaching {\n  isServer: boolean\n  isPageFile: boolean\n  isNextDist: boolean\n  hasModuleExports: boolean\n  fileExt: string\n}\n\nconst fileExtensionRegex = /\\.([a-z]+)$/\nfunction getCacheCharacteristics(\n  loaderOptions: NextBabelLoaderOptions,\n  source: string,\n  filename: string\n): CharacteristicsGermaneToCaching {\n  const { isServer, pagesDir } = loaderOptions\n  const isPageFile = filename.startsWith(pagesDir)\n  const isNextDist = nextDistPath.test(filename)\n  const hasModuleExports = source.indexOf('module.exports') !== -1\n  const fileExt = fileExtensionRegex.exec(filename)?.[1] || 'unknown'\n\n  return {\n    isServer,\n    isPageFile,\n    isNextDist,\n    hasModuleExports,\n    fileExt,\n  }\n}\n\n/**\n * Return an array of Babel plugins, conditioned upon loader options and\n * source file characteristics.\n */\nfunction getPlugins(\n  loaderOptions: NextBabelLoaderOptions,\n  cacheCharacteristics: CharacteristicsGermaneToCaching\n) {\n  const { isServer, isPageFile, isNextDist, hasModuleExports } =\n    cacheCharacteristics\n\n  const { hasReactRefresh, development } = loaderOptions\n\n  const applyCommonJsItem = hasModuleExports\n    ? createConfigItem(require('../plugins/commonjs'), { type: 'plugin' })\n    : null\n  const reactRefreshItem = hasReactRefresh\n    ? createConfigItem(\n        [\n          require('next/dist/compiled/react-refresh/babel'),\n          { skipEnvCheck: true },\n        ],\n        { type: 'plugin' }\n      )\n    : null\n  const pageConfigItem =\n    !isServer && isPageFile\n      ? createConfigItem([require('../plugins/next-page-config')], {\n          type: 'plugin',\n        })\n      : null\n  const disallowExportAllItem =\n    !isServer && isPageFile\n      ? createConfigItem(\n          [require('../plugins/next-page-disallow-re-export-all-exports')],\n          { type: 'plugin' }\n        )\n      : null\n  const transformDefineItem = createConfigItem(\n    [\n      require.resolve('next/dist/compiled/babel/plugin-transform-define'),\n      {\n        'process.env.NODE_ENV': development ? 'development' : 'production',\n        'typeof window': isServer ? 'undefined' : 'object',\n        'process.browser': isServer ? false : true,\n      },\n      'next-js-transform-define-instance',\n    ],\n    { type: 'plugin' }\n  )\n  const nextSsgItem =\n    !isServer && isPageFile\n      ? createConfigItem([require.resolve('../plugins/next-ssg-transform')], {\n          type: 'plugin',\n        })\n      : null\n  const commonJsItem = isNextDist\n    ? createConfigItem(\n        require('next/dist/compiled/babel/plugin-transform-modules-commonjs'),\n        { type: 'plugin' }\n      )\n    : null\n\n  return [\n    reactRefreshItem,\n    pageConfigItem,\n    disallowExportAllItem,\n    applyCommonJsItem,\n    transformDefineItem,\n    nextSsgItem,\n    commonJsItem,\n  ].filter(Boolean)\n}\n\nconst isJsonFile = /\\.(json|babelrc)$/\nconst isJsFile = /\\.js$/\n\n/**\n * While this function does block execution while reading from disk, it\n * should not introduce any issues.  The function is only invoked when\n * generating a fresh config, and only a small handful of configs should\n * be generated during compilation.\n */\nfunction getCustomBabelConfig(configFilePath: string) {\n  if (isJsonFile.exec(configFilePath)) {\n    const babelConfigRaw = readFileSync(configFilePath, 'utf8')\n    return JSON5.parse(babelConfigRaw)\n  } else if (isJsFile.exec(configFilePath)) {\n    return require(configFilePath)\n  }\n  throw new Error(\n    'The Next.js Babel loader does not support .mjs or .cjs config files.'\n  )\n}\n\n/**\n * Generate a new, flat Babel config, ready to be handed to Babel-traverse.\n * This config should have no unresolved overrides, presets, etc.\n */\nfunction getFreshConfig(\n  this: NextJsLoaderContext,\n  cacheCharacteristics: CharacteristicsGermaneToCaching,\n  loaderOptions: NextBabelLoaderOptions,\n  target: string,\n  filename: string,\n  inputSourceMap?: object | null\n) {\n  let { isServer, pagesDir, development, hasJsxRuntime, configFile } =\n    loaderOptions\n\n  let customConfig: any = configFile\n    ? getCustomBabelConfig(configFile)\n    : undefined\n\n  let options = {\n    babelrc: false,\n    cloneInputAst: false,\n    filename,\n    inputSourceMap: inputSourceMap || undefined,\n\n    // Set the default sourcemap behavior based on Webpack's mapping flag,\n    // but allow users to override if they want.\n    sourceMaps:\n      loaderOptions.sourceMaps === undefined\n        ? this.sourceMap\n        : loaderOptions.sourceMaps,\n\n    // Ensure that Webpack will get a full absolute path in the sourcemap\n    // so that it can properly map the module back to its internal cached\n    // modules.\n    sourceFileName: filename,\n\n    plugins: [\n      ...getPlugins(loaderOptions, cacheCharacteristics),\n      ...(customConfig?.plugins || []),\n    ],\n\n    // target can be provided in babelrc\n    target: isServer ? undefined : customConfig?.target,\n    // env can be provided in babelrc\n    env: customConfig?.env,\n\n    presets: (() => {\n      // If presets is defined the user will have next/babel in their babelrc\n      if (customConfig?.presets) {\n        return customConfig.presets\n      }\n\n      // If presets is not defined the user will likely have \"env\" in their babelrc\n      if (customConfig) {\n        return undefined\n      }\n\n      // If no custom config is provided the default is to use next/babel\n      return ['next/babel']\n    })(),\n\n    overrides: loaderOptions.overrides,\n\n    caller: {\n      name: 'next-babel-turbo-loader',\n      supportsStaticESM: true,\n      supportsDynamicImport: true,\n\n      // Provide plugins with insight into webpack target.\n      // https://github.com/babel/babel-loader/issues/787\n      target: target,\n\n      // Webpack 5 supports TLA behind a flag. We enable it by default\n      // for Babel, and then webpack will throw an error if the experimental\n      // flag isn't enabled.\n      supportsTopLevelAwait: true,\n\n      isServer,\n      pagesDir,\n      isDev: development,\n      hasJsxRuntime,\n\n      ...loaderOptions.caller,\n    },\n  } as any\n\n  // Babel does strict checks on the config so undefined is not allowed\n  if (typeof options.target === 'undefined') {\n    delete options.target\n  }\n\n  Object.defineProperty(options.caller, 'onWarning', {\n    enumerable: false,\n    writable: false,\n    value: (reason: any) => {\n      if (!(reason instanceof Error)) {\n        reason = new Error(reason)\n      }\n      this.emitWarning(reason)\n    },\n  })\n\n  const loadedOptions = loadOptions(options)\n  const config = consumeIterator(loadConfig(loadedOptions))\n\n  return config\n}\n\n/**\n * Each key returned here corresponds with a Babel config that can be shared.\n * The conditions of permissible sharing between files is dependent on specific\n * file attributes and Next.js compiler states: `CharacteristicsGermaneToCaching`.\n */\nfunction getCacheKey(cacheCharacteristics: CharacteristicsGermaneToCaching) {\n  const { isServer, isPageFile, isNextDist, hasModuleExports, fileExt } =\n    cacheCharacteristics\n\n  const flags =\n    0 |\n    (isServer ? 0b0001 : 0) |\n    (isPageFile ? 0b0010 : 0) |\n    (isNextDist ? 0b0100 : 0) |\n    (hasModuleExports ? 0b1000 : 0)\n\n  return fileExt + flags\n}\n\ntype BabelConfig = any\nconst configCache: Map<any, BabelConfig> = new Map()\nconst configFiles: Set<string> = new Set()\n\nexport default function getConfig(\n  this: NextJsLoaderContext,\n  {\n    source,\n    target,\n    loaderOptions,\n    filename,\n    inputSourceMap,\n  }: {\n    source: string\n    loaderOptions: NextBabelLoaderOptions\n    target: string\n    filename: string\n    inputSourceMap?: object | null\n  }\n): BabelConfig {\n  const cacheCharacteristics = getCacheCharacteristics(\n    loaderOptions,\n    source,\n    filename\n  )\n\n  if (loaderOptions.configFile) {\n    // Ensures webpack invalidates the cache for this loader when the config file changes\n    this.addDependency(loaderOptions.configFile)\n  }\n\n  const cacheKey = getCacheKey(cacheCharacteristics)\n  if (configCache.has(cacheKey)) {\n    const cachedConfig = configCache.get(cacheKey)\n\n    return {\n      ...cachedConfig,\n      options: {\n        ...cachedConfig.options,\n        cwd: loaderOptions.cwd,\n        root: loaderOptions.cwd,\n        filename,\n        sourceFileName: filename,\n      },\n    }\n  }\n\n  if (loaderOptions.configFile && !configFiles.has(loaderOptions.configFile)) {\n    configFiles.add(loaderOptions.configFile)\n    Log.info(\n      `Using external babel configuration from ${loaderOptions.configFile}`\n    )\n  }\n\n  const freshConfig = getFreshConfig.call(\n    this,\n    cacheCharacteristics,\n    loaderOptions,\n    target,\n    filename,\n    inputSourceMap\n  )\n\n  configCache.set(cacheKey, freshConfig)\n\n  return freshConfig\n}\n"],"names":["getConfig","Log","nextDistPath","fileExtensionRegex","getCacheCharacteristics","loaderOptions","source","filename","isServer","pagesDir","isPageFile","startsWith","isNextDist","test","hasModuleExports","indexOf","fileExt","exec","getPlugins","cacheCharacteristics","hasReactRefresh","development","applyCommonJsItem","require","type","reactRefreshItem","skipEnvCheck","pageConfigItem","disallowExportAllItem","transformDefineItem","resolve","nextSsgItem","commonJsItem","filter","Boolean","isJsonFile","isJsFile","getCustomBabelConfig","configFilePath","babelConfigRaw","parse","Error","getFreshConfig","target","inputSourceMap","hasJsxRuntime","configFile","customConfig","undefined","options","babelrc","cloneInputAst","sourceMaps","sourceMap","sourceFileName","plugins","env","presets","overrides","caller","name","supportsStaticESM","supportsDynamicImport","supportsTopLevelAwait","isDev","Object","defineProperty","enumerable","writable","value","reason","emitWarning","loadedOptions","config","getCacheKey","flags","configCache","Map","configFiles","Set","addDependency","cacheKey","has","cachedConfig","get","cwd","root","add","info","freshConfig","call","set"],"mappings":"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"}