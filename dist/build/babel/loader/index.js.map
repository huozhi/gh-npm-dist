{"version":3,"sources":["../../../../build/babel/loader/index.ts"],"sourcesContent":["import { Span } from '../../../trace'\nimport transform from './transform'\nimport { NextJsLoaderContext } from './types'\n\nasync function nextBabelLoader(\n  this: NextJsLoaderContext,\n  parentTrace: Span,\n  inputSource: string,\n  inputSourceMap: object | null | undefined\n) {\n  const filename = this.resourcePath\n  const target = this.target\n  const loaderOptions = parentTrace\n    .traceChild('get-options')\n    // @ts-ignore TODO: remove ignore once webpack 5 types are used\n    .traceFn(() => this.getOptions())\n\n  const loaderSpanInner = parentTrace.traceChild('next-babel-turbo-transform')\n  const { code: transformedSource, map: outputSourceMap } =\n    loaderSpanInner.traceFn(() =>\n      transform.call(\n        this,\n        inputSource,\n        inputSourceMap,\n        loaderOptions,\n        filename,\n        target,\n        loaderSpanInner\n      )\n    )\n\n  return [transformedSource, outputSourceMap]\n}\n\nconst nextBabelLoaderOuter = function nextBabelLoaderOuter(\n  this: NextJsLoaderContext,\n  inputSource: string,\n  inputSourceMap: object | null | undefined\n) {\n  const callback = this.async()\n\n  const loaderSpan = this.currentTraceSpan.traceChild('next-babel-turbo-loader')\n  loaderSpan\n    .traceAsyncFn(() =>\n      nextBabelLoader.call(this, loaderSpan, inputSource, inputSourceMap)\n    )\n    .then(\n      ([transformedSource, outputSourceMap]) =>\n        callback?.(null, transformedSource, outputSourceMap || inputSourceMap),\n      (err) => {\n        callback?.(err)\n      }\n    )\n}\n\nexport default nextBabelLoaderOuter\n"],"names":["nextBabelLoader","parentTrace","inputSource","inputSourceMap","filename","resourcePath","target","loaderOptions","traceChild","traceFn","getOptions","loaderSpanInner","code","transformedSource","map","outputSourceMap","call","nextBabelLoaderOuter","callback","async","loaderSpan","currentTraceSpan","traceAsyncFn","then","err"],"mappings":";;;;;AACsB,GAAa,CAAb,UAAa;;;;;;eAGpBA,eAAe,CAE5BC,WAAiB,EACjBC,WAAmB,EACnBC,cAAyC,EACzC,CAAC;IACD,KAAK,CAACC,QAAQ,GAAG,IAAI,CAACC,YAAY;IAClC,KAAK,CAACC,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,KAAK,CAACC,aAAa,GAAGN,WAAW,CAC9BO,UAAU,CAAC,CAAa,aACzB,EAA+D,AAA/D,6DAA+D;KAC9DC,OAAO,KAAO,IAAI,CAACC,UAAU;;IAEhC,KAAK,CAACC,eAAe,GAAGV,WAAW,CAACO,UAAU,CAAC,CAA4B;IAC3E,KAAK,CAAC,CAAC,CAACI,IAAI,EAAEC,iBAAiB,GAAEC,GAAG,EAAEC,eAAe,EAAC,CAAC,GACrDJ,eAAe,CAACF,OAAO,KAlBL,UAAa,SAmBnBO,IAAI,CACZ,IAAI,EACJd,WAAW,EACXC,cAAc,EACdI,aAAa,EACbH,QAAQ,EACRE,MAAM,EACNK,eAAe;;IAIrB,MAAM,CAAC,CAACE;QAAAA,iBAAiB;QAAEE,eAAe;IAAA,CAAC;AAC7C,CAAC;AAED,KAAK,CAACE,oBAAoB,GAAG,QAAQ,CAACA,oBAAoB,CAExDf,WAAmB,EACnBC,cAAyC,EACzC,CAAC;IACD,KAAK,CAACe,QAAQ,GAAG,IAAI,CAACC,KAAK;IAE3B,KAAK,CAACC,UAAU,GAAG,IAAI,CAACC,gBAAgB,CAACb,UAAU,CAAC,CAAyB;IAC7EY,UAAU,CACPE,YAAY,KACXtB,eAAe,CAACgB,IAAI,CAAC,IAAI,EAAEI,UAAU,EAAElB,WAAW,EAAEC,cAAc;MAEnEoB,IAAI,GACDV,iBAAiB,EAAEE,eAAe;eAClCG,QAAQ,aAARA,QAAQ,KAARA,IAAI,CAAJA,CAAsE,GAAtEA,IAAI,CAAJA,CAAsE,GAAtEA,QAAQ,CAAG,IAAI,EAAEL,iBAAiB,EAAEE,eAAe,IAAIZ,cAAc;QACtEqB,GAAG,GAAK,CAAC;QACRN,QAAQ,aAARA,QAAQ,KAARA,IAAI,CAAJA,CAAe,GAAfA,IAAI,CAAJA,CAAe,GAAfA,QAAQ,CAAGM,GAAG;IAChB,CAAC;AAEP,CAAC;eAEcP,oBAAoB"}