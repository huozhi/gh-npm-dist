{"version":3,"sources":["../../../build/output/index.ts"],"sourcesContent":["import chalk from 'next/dist/compiled/chalk'\nimport stripAnsi from 'next/dist/compiled/strip-ansi'\nimport textTable from 'next/dist/compiled/text-table'\nimport createStore from 'next/dist/compiled/unistore'\nimport formatWebpackMessages from '../../client/dev/error-overlay/format-webpack-messages'\nimport { OutputState, store as consoleStore } from './store'\nimport type { webpack5 } from 'next/dist/compiled/webpack/webpack'\n\nexport function startedDevelopmentServer(appUrl: string, bindAddr: string) {\n  consoleStore.setState({ appUrl, bindAddr })\n}\n\nlet previousClient: webpack5.Compiler | null = null\nlet previousServer: webpack5.Compiler | null = null\nlet previousServerWeb: webpack5.Compiler | null = null\n\ntype CompilerDiagnostics = {\n  modules: number\n  errors: string[] | null\n  warnings: string[] | null\n}\n\ntype WebpackStatus =\n  | { loading: true }\n  | ({ loading: false } & CompilerDiagnostics)\n\ntype AmpStatus = {\n  message: string\n  line: number\n  col: number\n  specUrl: string | null\n  code: string\n}\n\nexport type AmpPageStatus = {\n  [page: string]: { errors: AmpStatus[]; warnings: AmpStatus[] }\n}\n\ntype BuildStatusStore = {\n  client: WebpackStatus\n  server: WebpackStatus\n  serverWeb?: WebpackStatus\n  trigger: string | undefined\n  amp: AmpPageStatus\n}\n\nexport function formatAmpMessages(amp: AmpPageStatus) {\n  let output = chalk.bold('Amp Validation') + '\\n\\n'\n  let messages: string[][] = []\n\n  const chalkError = chalk.red('error')\n  function ampError(page: string, error: AmpStatus) {\n    messages.push([page, chalkError, error.message, error.specUrl || ''])\n  }\n\n  const chalkWarn = chalk.yellow('warn')\n  function ampWarn(page: string, warn: AmpStatus) {\n    messages.push([page, chalkWarn, warn.message, warn.specUrl || ''])\n  }\n\n  for (const page in amp) {\n    let { errors, warnings } = amp[page]\n\n    const devOnlyFilter = (err: AmpStatus) => err.code !== 'DEV_MODE_ONLY'\n    errors = errors.filter(devOnlyFilter)\n    warnings = warnings.filter(devOnlyFilter)\n    if (!(errors.length || warnings.length)) {\n      // Skip page with no non-dev warnings\n      continue\n    }\n\n    if (errors.length) {\n      ampError(page, errors[0])\n      for (let index = 1; index < errors.length; ++index) {\n        ampError('', errors[index])\n      }\n    }\n    if (warnings.length) {\n      ampWarn(errors.length ? '' : page, warnings[0])\n      for (let index = 1; index < warnings.length; ++index) {\n        ampWarn('', warnings[index])\n      }\n    }\n    messages.push(['', '', '', ''])\n  }\n\n  if (!messages.length) {\n    return ''\n  }\n\n  output += textTable(messages, {\n    align: ['l', 'l', 'l', 'l'],\n    stringLength(str: string) {\n      return stripAnsi(str).length\n    },\n  })\n\n  return output\n}\n\nconst buildStore = createStore<BuildStatusStore>()\nlet buildWasDone = false\nlet clientWasLoading = true\nlet serverWasLoading = true\nlet serverWebWasLoading = false\n\nbuildStore.subscribe((state) => {\n  const { amp, client, server, serverWeb, trigger } = state\n\n  const { appUrl } = consoleStore.getState()\n\n  if (client.loading || server.loading || serverWeb?.loading) {\n    consoleStore.setState(\n      {\n        bootstrap: false,\n        appUrl: appUrl!,\n        loading: true,\n        trigger,\n      } as OutputState,\n      true\n    )\n    clientWasLoading = (!buildWasDone && clientWasLoading) || client.loading\n    serverWasLoading = (!buildWasDone && serverWasLoading) || server.loading\n    serverWebWasLoading =\n      (!buildWasDone && serverWasLoading) || !!serverWeb?.loading\n    buildWasDone = false\n    return\n  }\n  if (serverWeb?.loading) return\n\n  buildWasDone = true\n\n  let partialState: Partial<OutputState> = {\n    bootstrap: false,\n    appUrl: appUrl!,\n    loading: false,\n    typeChecking: false,\n    partial:\n      clientWasLoading && (serverWasLoading || serverWebWasLoading)\n        ? 'client and server'\n        : undefined,\n    modules:\n      (clientWasLoading ? client.modules : 0) +\n      (serverWasLoading ? server.modules : 0) +\n      (serverWebWasLoading ? serverWeb?.modules || 0 : 0),\n    hasServerWeb: !!serverWeb,\n  }\n  if (client.errors) {\n    // Show only client errors\n    consoleStore.setState(\n      {\n        ...partialState,\n        errors: client.errors,\n        warnings: null,\n      } as OutputState,\n      true\n    )\n  } else if (server.errors) {\n    // Show only server errors\n    consoleStore.setState(\n      {\n        ...partialState,\n        errors: server.errors,\n        warnings: null,\n      } as OutputState,\n      true\n    )\n  } else if (serverWeb && serverWeb.errors) {\n    // Show only serverWeb errors\n    consoleStore.setState(\n      {\n        ...partialState,\n        errors: serverWeb.errors,\n        warnings: null,\n      } as OutputState,\n      true\n    )\n  } else {\n    // Show warnings from all of them\n    const warnings = [\n      ...(client.warnings || []),\n      ...(server.warnings || []),\n      ...((serverWeb && serverWeb.warnings) || []),\n    ].concat(formatAmpMessages(amp) || [])\n\n    consoleStore.setState(\n      {\n        ...partialState,\n        errors: null,\n        warnings: warnings.length === 0 ? null : warnings,\n      } as OutputState,\n      true\n    )\n  }\n})\n\nexport function ampValidation(\n  page: string,\n  errors: AmpStatus[],\n  warnings: AmpStatus[]\n) {\n  const { amp } = buildStore.getState()\n  if (!(errors.length || warnings.length)) {\n    buildStore.setState({\n      amp: Object.keys(amp)\n        .filter((k) => k !== page)\n        .sort()\n        // eslint-disable-next-line no-sequences\n        .reduce((a, c) => ((a[c] = amp[c]), a), {} as AmpPageStatus),\n    })\n    return\n  }\n\n  const newAmp: AmpPageStatus = { ...amp, [page]: { errors, warnings } }\n  buildStore.setState({\n    amp: Object.keys(newAmp)\n      .sort()\n      // eslint-disable-next-line no-sequences\n      .reduce((a, c) => ((a[c] = newAmp[c]), a), {} as AmpPageStatus),\n  })\n}\n\nexport function watchCompilers(\n  client: webpack5.Compiler,\n  server: webpack5.Compiler,\n  serverWeb: webpack5.Compiler\n) {\n  if (\n    previousClient === client &&\n    previousServer === server &&\n    previousServerWeb === serverWeb\n  ) {\n    return\n  }\n\n  buildStore.setState({\n    client: { loading: true },\n    server: { loading: true },\n    serverWeb: serverWeb ? { loading: true } : undefined,\n    trigger: 'initial',\n  })\n\n  function tapCompiler(\n    key: string,\n    compiler: any,\n    onEvent: (status: WebpackStatus) => void\n  ) {\n    compiler.hooks.invalid.tap(`NextJsInvalid-${key}`, () => {\n      onEvent({ loading: true })\n    })\n\n    compiler.hooks.done.tap(`NextJsDone-${key}`, (stats: webpack5.Stats) => {\n      buildStore.setState({ amp: {} })\n\n      const { errors, warnings } = formatWebpackMessages(\n        stats.toJson({\n          preset: 'errors-warnings',\n          moduleTrace: true,\n        })\n      )\n\n      const hasErrors = !!errors?.length\n      const hasWarnings = !!warnings?.length\n\n      onEvent({\n        loading: false,\n        modules: stats.compilation.modules.size,\n        errors: hasErrors ? errors : null,\n        warnings: hasWarnings ? warnings : null,\n      })\n    })\n  }\n\n  tapCompiler('client', client, (status) => {\n    if (!status.loading && !buildStore.getState().server.loading) {\n      buildStore.setState({\n        client: status,\n        trigger: undefined,\n      })\n    } else {\n      buildStore.setState({\n        client: status,\n      })\n    }\n  })\n  tapCompiler('server', server, (status) => {\n    if (!status.loading && !buildStore.getState().client.loading) {\n      buildStore.setState({\n        server: status,\n        trigger: undefined,\n      })\n    } else {\n      buildStore.setState({\n        server: status,\n      })\n    }\n  })\n  if (serverWeb) {\n    tapCompiler('serverWeb', serverWeb, (status) => {\n      buildStore.setState({\n        serverWeb: status,\n        trigger: undefined,\n      })\n    })\n  }\n\n  previousClient = client\n  previousServer = server\n  previousServerWeb = serverWeb\n}\n\nexport function reportTrigger(trigger: string) {\n  buildStore.setState({\n    trigger,\n  })\n}\n"],"names":["startedDevelopmentServer","formatAmpMessages","ampValidation","watchCompilers","reportTrigger","appUrl","bindAddr","setState","previousClient","previousServer","previousServerWeb","amp","output","bold","messages","chalkError","red","ampError","page","error","push","message","specUrl","chalkWarn","yellow","ampWarn","warn","errors","warnings","devOnlyFilter","err","code","filter","length","index","align","stringLength","str","buildStore","buildWasDone","clientWasLoading","serverWasLoading","serverWebWasLoading","subscribe","state","client","server","serverWeb","trigger","getState","loading","bootstrap","partialState","typeChecking","partial","undefined","modules","hasServerWeb","concat","Object","keys","k","sort","reduce","a","c","newAmp","tapCompiler","key","compiler","onEvent","hooks","invalid","tap","done","stats","toJson","preset","moduleTrace","hasErrors","hasWarnings","compilation","size","status"],"mappings":"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"}