{"version":3,"sources":["../../../../../build/webpack/plugins/wellknown-errors-plugin/parseScss.ts"],"sourcesContent":["import { codeFrameColumns } from 'next/dist/compiled/babel/code-frame'\nimport Chalk from 'next/dist/compiled/chalk'\nimport { SimpleWebpackError } from './simpleWebpackError'\n\nconst chalk = new Chalk.constructor({ enabled: true })\nconst regexScssError =\n  /SassError: (.+)\\n\\s+on line (\\d+) [\\s\\S]*?>> (.+)\\n\\s*(-+)\\^$/m\n\nexport function getScssError(\n  fileName: string,\n  fileContent: string | null,\n  err: Error\n): SimpleWebpackError | false {\n  if (err.name !== 'SassError') {\n    return false\n  }\n\n  const res = regexScssError.exec(err.message)\n  if (res) {\n    const [, reason, _lineNumer, backupFrame, columnString] = res\n    const lineNumber = Math.max(1, parseInt(_lineNumer, 10))\n    const column = columnString?.length ?? 1\n\n    let frame: string | undefined\n    if (fileContent) {\n      try {\n        frame = codeFrameColumns(\n          fileContent,\n          { start: { line: lineNumber, column } },\n          { forceColor: true }\n        ) as string\n      } catch {}\n    }\n\n    return new SimpleWebpackError(\n      `${chalk.cyan(fileName)}:${chalk.yellow(\n        lineNumber.toString()\n      )}:${chalk.yellow(column.toString())}`,\n      chalk.red\n        .bold('Syntax error')\n        .concat(`: ${reason}\\n\\n${frame ?? backupFrame}`)\n    )\n  }\n\n  return false\n}\n"],"names":["getScssError","chalk","constructor","enabled","regexScssError","fileName","fileContent","err","name","res","exec","message","reason","_lineNumer","backupFrame","columnString","lineNumber","Math","max","parseInt","column","length","frame","start","line","forceColor","cyan","yellow","toString","red","bold","concat"],"mappings":";;;;QAQgBA,YAAY,GAAZA,YAAY;AARK,GAAqC,CAArC,UAAqC;AACpD,GAA0B,CAA1B,MAA0B;AACT,GAAsB,CAAtB,mBAAsB;;;;;;AAEzD,KAAK,CAACC,KAAK,GAAG,GAAG,CAHC,MAA0B,SAGpBC,WAAW,CAAC,CAAC;IAACC,OAAO,EAAE,IAAI;AAAC,CAAC;AACrD,KAAK,CAACC,cAAc;SAGJJ,YAAY,CAC1BK,QAAgB,EAChBC,WAA0B,EAC1BC,GAAU,EACkB,CAAC;IAC7B,EAAE,EAAEA,GAAG,CAACC,IAAI,KAAK,CAAW,YAAE,CAAC;QAC7B,MAAM,CAAC,KAAK;IACd,CAAC;IAED,KAAK,CAACC,GAAG,GAAGL,cAAc,CAACM,IAAI,CAACH,GAAG,CAACI,OAAO;IAC3C,EAAE,EAAEF,GAAG,EAAE,CAAC;QACR,KAAK,IAAIG,MAAM,EAAEC,UAAU,EAAEC,WAAW,EAAEC,YAAY,IAAIN,GAAG;QAC7D,KAAK,CAACO,UAAU,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEC,QAAQ,CAACN,UAAU,EAAE,EAAE;YACvCE,GAAoB;QAAnC,KAAK,CAACK,MAAM,IAAGL,GAAoB,GAApBA,YAAY,aAAZA,YAAY,KAAZA,IAAI,CAAJA,CAAoB,GAApBA,IAAI,CAAJA,CAAoB,GAApBA,YAAY,CAAEM,MAAM,cAApBN,GAAoB,cAApBA,GAAoB,GAAI,CAAC;QAExC,GAAG,CAACO,KAAK;QACT,EAAE,EAAEhB,WAAW,EAAE,CAAC;YAChB,GAAG,CAAC,CAAC;gBACHgB,KAAK,OA1BoB,UAAqC,mBA2B5DhB,WAAW,EACX,CAAC;oBAACiB,KAAK,EAAE,CAAC;wBAACC,IAAI,EAAER,UAAU;wBAAEI,MAAM;oBAAC,CAAC;gBAAC,CAAC,EACvC,CAAC;oBAACK,UAAU,EAAE,IAAI;gBAAC,CAAC;YAExB,CAAC,CAAC,KAAK,EAAC,CAAC,CAAC;QACZ,CAAC;QAED,MAAM,CAAC,GAAG,CAhCqB,mBAAsB,uBAiChDxB,KAAK,CAACyB,IAAI,CAACrB,QAAQ,EAAE,CAAC,EAAEJ,KAAK,CAAC0B,MAAM,CACrCX,UAAU,CAACY,QAAQ,IACnB,CAAC,EAAE3B,KAAK,CAAC0B,MAAM,CAACP,MAAM,CAACQ,QAAQ,OACjC3B,KAAK,CAAC4B,GAAG,CACNC,IAAI,CAAC,CAAc,eACnBC,MAAM,EAAE,EAAE,EAAEnB,MAAM,CAAC,IAAI,EAAEU,KAAK,aAALA,KAAK,cAALA,KAAK,GAAIR,WAAW;IAEpD,CAAC;IAED,MAAM,CAAC,KAAK;AACd,CAAC"}