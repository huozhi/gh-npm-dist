{"version":3,"sources":["../../../../build/webpack/plugins/next-trace-entrypoints-plugin.ts"],"sourcesContent":["import nodePath from 'path'\nimport { Span } from '../../../trace'\nimport { spans } from './profiling-plugin'\nimport isError from '../../../lib/is-error'\nimport {\n  nodeFileTrace,\n  NodeFileTraceReasons,\n} from 'next/dist/compiled/@vercel/nft'\nimport { TRACE_OUTPUT_VERSION } from '../../../shared/lib/constants'\nimport { webpack, sources } from 'next/dist/compiled/webpack/webpack'\nimport type { webpack5 } from 'next/dist/compiled/webpack/webpack'\nimport {\n  NODE_ESM_RESOLVE_OPTIONS,\n  NODE_RESOLVE_OPTIONS,\n  resolveExternal,\n} from '../../webpack-config'\nimport { NextConfigComplete } from '../../../server/config-shared'\n\nconst PLUGIN_NAME = 'TraceEntryPointsPlugin'\nconst TRACE_IGNORES = [\n  '**/*/next/dist/server/next.js',\n  '**/*/next/dist/bin/next',\n]\n\nfunction getModuleFromDependency(\n  compilation: any,\n  dep: any\n): webpack5.Module & { resource?: string } {\n  return compilation.moduleGraph.getModule(dep)\n}\n\nfunction getFilesMapFromReasons(\n  fileList: Set<string>,\n  reasons: NodeFileTraceReasons,\n  ignoreFn?: (file: string, parent?: string) => Boolean\n) {\n  // this uses the reasons tree to collect files specific to a\n  // certain parent allowing us to not have to trace each parent\n  // separately\n  const parentFilesMap = new Map<string, Set<string>>()\n\n  function propagateToParents(\n    parents: Set<string>,\n    file: string,\n    seen = new Set<string>()\n  ) {\n    for (const parent of parents || []) {\n      if (!seen.has(parent)) {\n        seen.add(parent)\n        let parentFiles = parentFilesMap.get(parent)\n\n        if (!parentFiles) {\n          parentFiles = new Set()\n          parentFilesMap.set(parent, parentFiles)\n        }\n\n        if (!ignoreFn?.(file, parent)) {\n          parentFiles.add(file)\n        }\n        const parentReason = reasons.get(parent)\n\n        if (parentReason?.parents) {\n          propagateToParents(parentReason.parents, file, seen)\n        }\n      }\n    }\n  }\n\n  for (const file of fileList!) {\n    const reason = reasons!.get(file)\n\n    if (\n      !reason ||\n      !reason.parents ||\n      (reason.type === 'initial' && reason.parents.size === 0)\n    ) {\n      continue\n    }\n    propagateToParents(reason.parents, file)\n  }\n  return parentFilesMap\n}\n\nexport class TraceEntryPointsPlugin implements webpack5.WebpackPluginInstance {\n  private appDir: string\n  private tracingRoot: string\n  private entryTraces: Map<string, Set<string>>\n  private excludeFiles: string[]\n  private esmExternals?: NextConfigComplete['experimental']['esmExternals']\n  private staticImageImports?: boolean\n\n  constructor({\n    appDir,\n    excludeFiles,\n    esmExternals,\n    staticImageImports,\n    outputFileTracingRoot,\n  }: {\n    appDir: string\n    excludeFiles?: string[]\n    staticImageImports: boolean\n    outputFileTracingRoot?: string\n    esmExternals?: NextConfigComplete['experimental']['esmExternals']\n  }) {\n    this.appDir = appDir\n    this.entryTraces = new Map()\n    this.esmExternals = esmExternals\n    this.excludeFiles = excludeFiles || []\n    this.staticImageImports = staticImageImports\n    this.tracingRoot = outputFileTracingRoot || appDir\n  }\n\n  // Here we output all traced assets and webpack chunks to a\n  // ${page}.js.nft.json file\n  async createTraceAssets(\n    compilation: any,\n    assets: any,\n    span: Span,\n    readlink: any,\n    stat: any\n  ) {\n    const outputPath = compilation.outputOptions.path\n\n    await span.traceChild('create-trace-assets').traceAsyncFn(async () => {\n      const entryFilesMap = new Map<any, Set<string>>()\n      const chunksToTrace = new Set<string>()\n\n      for (const entrypoint of compilation.entrypoints.values()) {\n        const entryFiles = new Set<string>()\n\n        for (const chunk of entrypoint\n          .getEntrypointChunk()\n          .getAllReferencedChunks()) {\n          for (const file of chunk.files) {\n            const filePath = nodePath.join(outputPath, file)\n            chunksToTrace.add(filePath)\n            entryFiles.add(filePath)\n          }\n          for (const file of chunk.auxiliaryFiles) {\n            const filePath = nodePath.join(outputPath, file)\n            chunksToTrace.add(filePath)\n            entryFiles.add(filePath)\n          }\n        }\n        entryFilesMap.set(entrypoint, entryFiles)\n      }\n\n      const result = await nodeFileTrace([...chunksToTrace], {\n        base: this.tracingRoot,\n        processCwd: this.appDir,\n        readFile: async (path) => {\n          if (chunksToTrace.has(path)) {\n            const source =\n              assets[\n                nodePath.relative(outputPath, path).replace(/\\\\/g, '/')\n              ]?.source?.()\n            if (source) return source\n          }\n          try {\n            return await new Promise((resolve, reject) => {\n              ;(\n                compilation.inputFileSystem\n                  .readFile as typeof import('fs').readFile\n              )(path, (err, data) => {\n                if (err) return reject(err)\n                resolve(data)\n              })\n            })\n          } catch (e) {\n            if (isError(e) && (e.code === 'ENOENT' || e.code === 'EISDIR')) {\n              return null\n            }\n            throw e\n          }\n        },\n        readlink,\n        stat,\n        ignore: [...TRACE_IGNORES, ...this.excludeFiles],\n        mixedModules: true,\n      })\n      const reasons = result.reasons\n      const fileList = result.fileList\n      result.esmFileList.forEach((file) => fileList.add(file))\n\n      const parentFilesMap = getFilesMapFromReasons(fileList, reasons)\n\n      for (const [entrypoint, entryFiles] of entryFilesMap) {\n        const traceOutputName = `../${entrypoint.name}.js.nft.json`\n        const traceOutputPath = nodePath.dirname(\n          nodePath.join(outputPath, traceOutputName)\n        )\n        const allEntryFiles = new Set<string>()\n\n        entryFiles.forEach((file) => {\n          parentFilesMap\n            .get(nodePath.relative(this.tracingRoot, file))\n            ?.forEach((child) => {\n              allEntryFiles.add(nodePath.join(this.tracingRoot, child))\n            })\n        })\n        // don't include the entry itself in the trace\n        entryFiles.delete(nodePath.join(outputPath, `../${entrypoint.name}.js`))\n\n        assets[traceOutputName] = new sources.RawSource(\n          JSON.stringify({\n            version: TRACE_OUTPUT_VERSION,\n            files: [\n              ...new Set([\n                ...entryFiles,\n                ...allEntryFiles,\n                ...(this.entryTraces.get(entrypoint.name) || []),\n              ]),\n            ].map((file) => {\n              return nodePath\n                .relative(traceOutputPath, file)\n                .replace(/\\\\/g, '/')\n            }),\n          })\n        )\n      }\n    })\n  }\n\n  tapfinishModules(\n    compilation: webpack5.Compilation,\n    traceEntrypointsPluginSpan: Span,\n    doResolve: (\n      request: string,\n      parent: string,\n      job: import('@vercel/nft/out/node-file-trace').Job,\n      isEsmRequested: boolean\n    ) => Promise<string>,\n    readlink: any,\n    stat: any\n  ) {\n    compilation.hooks.finishModules.tapAsync(\n      PLUGIN_NAME,\n      async (_stats: any, callback: any) => {\n        const finishModulesSpan =\n          traceEntrypointsPluginSpan.traceChild('finish-modules')\n        await finishModulesSpan\n          .traceAsyncFn(async () => {\n            // we create entry -> module maps so that we can\n            // look them up faster instead of having to iterate\n            // over the compilation modules list\n            const entryNameMap = new Map<string, string>()\n            const entryModMap = new Map<string, any>()\n            const additionalEntries = new Map<string, Map<string, any>>()\n\n            const depModMap = new Map<string, any>()\n\n            finishModulesSpan.traceChild('get-entries').traceFn(() => {\n              compilation.entries.forEach((entry, name) => {\n                if (name?.replace(/\\\\/g, '/').startsWith('pages/')) {\n                  for (const dep of entry.dependencies) {\n                    if (!dep) continue\n                    const entryMod = getModuleFromDependency(compilation, dep)\n\n                    if (entryMod && entryMod.resource) {\n                      if (\n                        entryMod.resource.replace(/\\\\/g, '/').includes('pages/')\n                      ) {\n                        entryNameMap.set(entryMod.resource, name)\n                        entryModMap.set(entryMod.resource, entryMod)\n                      } else {\n                        let curMap = additionalEntries.get(name)\n\n                        if (!curMap) {\n                          curMap = new Map()\n                          additionalEntries.set(name, curMap)\n                        }\n                        depModMap.set(entryMod.resource, entryMod)\n                        curMap.set(entryMod.resource, entryMod)\n                      }\n                    }\n                  }\n                }\n              })\n            })\n\n            const readFile = async (\n              path: string\n            ): Promise<Buffer | string | null> => {\n              const mod = depModMap.get(path) || entryModMap.get(path)\n\n              // map the transpiled source when available to avoid\n              // parse errors in node-file-trace\n              const source = mod?.originalSource?.()\n\n              if (source) {\n                return source.buffer()\n              }\n              // we don't want to analyze non-transpiled\n              // files here, that is done against webpack output\n              return ''\n            }\n\n            const entryPaths = Array.from(entryModMap.keys())\n\n            const collectDependencies = (mod: any) => {\n              if (!mod || !mod.dependencies) return\n\n              for (const dep of mod.dependencies) {\n                const depMod = getModuleFromDependency(compilation, dep)\n\n                if (depMod?.resource && !depModMap.get(depMod.resource)) {\n                  depModMap.set(depMod.resource, depMod)\n                  collectDependencies(depMod)\n                }\n              }\n            }\n            const entriesToTrace = [...entryPaths]\n\n            entryPaths.forEach((entry) => {\n              collectDependencies(entryModMap.get(entry))\n              const entryName = entryNameMap.get(entry)!\n              const curExtraEntries = additionalEntries.get(entryName)\n\n              if (curExtraEntries) {\n                entriesToTrace.push(...curExtraEntries.keys())\n              }\n            })\n            let fileList: Set<string>\n            let reasons: NodeFileTraceReasons\n            await finishModulesSpan\n              .traceChild('node-file-trace', {\n                traceEntryCount: entriesToTrace.length + '',\n              })\n              .traceAsyncFn(async () => {\n                const result = await nodeFileTrace(entriesToTrace, {\n                  base: this.tracingRoot,\n                  processCwd: this.appDir,\n                  readFile,\n                  readlink,\n                  stat,\n                  resolve: doResolve\n                    ? async (id, parent, job, isCjs) => {\n                        return doResolve(id, parent, job, !isCjs)\n                      }\n                    : undefined,\n                  ignore: [\n                    ...TRACE_IGNORES,\n                    ...this.excludeFiles,\n                    '**/node_modules/**',\n                  ],\n                  mixedModules: true,\n                })\n                // @ts-ignore\n                fileList = result.fileList\n                result.esmFileList.forEach((file) => fileList.add(file))\n                reasons = result.reasons\n              })\n\n            await finishModulesSpan\n              .traceChild('collect-traced-files')\n              .traceAsyncFn(() => {\n                const parentFilesMap = getFilesMapFromReasons(\n                  fileList,\n                  reasons,\n                  (file) => {\n                    file = nodePath.join(this.tracingRoot, file)\n                    const depMod = depModMap.get(file)\n\n                    return (\n                      Array.isArray(depMod?.loaders) &&\n                      depMod.loaders.length > 0\n                    )\n                  }\n                )\n                entryPaths.forEach((entry) => {\n                  const entryName = entryNameMap.get(entry)!\n                  const normalizedEntry = nodePath.relative(\n                    this.tracingRoot,\n                    entry\n                  )\n                  const curExtraEntries = additionalEntries.get(entryName)\n                  const finalDeps = new Set<string>()\n\n                  parentFilesMap.get(normalizedEntry)?.forEach((dep) => {\n                    finalDeps.add(nodePath.join(this.tracingRoot, dep))\n                  })\n\n                  if (curExtraEntries) {\n                    for (const extraEntry of curExtraEntries.keys()) {\n                      const normalizedExtraEntry = nodePath.relative(\n                        this.tracingRoot,\n                        extraEntry\n                      )\n                      finalDeps.add(extraEntry)\n                      parentFilesMap\n                        .get(normalizedExtraEntry)\n                        ?.forEach((dep) => {\n                          finalDeps.add(nodePath.join(this.tracingRoot, dep))\n                        })\n                    }\n                  }\n                  this.entryTraces.set(entryName, finalDeps)\n                })\n              })\n          })\n          .then(\n            () => callback(),\n            (err) => callback(err)\n          )\n      }\n    )\n  }\n\n  apply(compiler: webpack5.Compiler) {\n    compiler.hooks.compilation.tap(PLUGIN_NAME, (compilation) => {\n      const readlink = async (path: string): Promise<string | null> => {\n        try {\n          return await new Promise((resolve, reject) => {\n            ;(\n              compilation.inputFileSystem\n                .readlink as typeof import('fs').readlink\n            )(path, (err, link) => {\n              if (err) return reject(err)\n              resolve(link)\n            })\n          })\n        } catch (e) {\n          if (\n            isError(e) &&\n            (e.code === 'EINVAL' || e.code === 'ENOENT' || e.code === 'UNKNOWN')\n          ) {\n            return null\n          }\n          throw e\n        }\n      }\n      const stat = async (path: string): Promise<import('fs').Stats | null> => {\n        try {\n          return await new Promise((resolve, reject) => {\n            ;(compilation.inputFileSystem.stat as typeof import('fs').stat)(\n              path,\n              (err, stats) => {\n                if (err) return reject(err)\n                resolve(stats)\n              }\n            )\n          })\n        } catch (e) {\n          if (isError(e) && (e.code === 'ENOENT' || e.code === 'ENOTDIR')) {\n            return null\n          }\n          throw e\n        }\n      }\n\n      const compilationSpan = spans.get(compilation) || spans.get(compiler)!\n      const traceEntrypointsPluginSpan = compilationSpan.traceChild(\n        'next-trace-entrypoint-plugin'\n      )\n      traceEntrypointsPluginSpan.traceFn(() => {\n        // @ts-ignore TODO: Remove ignore when webpack 5 is stable\n        compilation.hooks.processAssets.tapAsync(\n          {\n            name: PLUGIN_NAME,\n            // @ts-ignore TODO: Remove ignore when webpack 5 is stable\n            stage: webpack.Compilation.PROCESS_ASSETS_STAGE_SUMMARIZE,\n          },\n          (assets: any, callback: any) => {\n            this.createTraceAssets(\n              compilation,\n              assets,\n              traceEntrypointsPluginSpan,\n              readlink,\n              stat\n            )\n              .then(() => callback())\n              .catch((err) => callback(err))\n          }\n        )\n\n        let resolver = compilation.resolverFactory.get('normal')\n\n        function getPkgName(name: string) {\n          const segments = name.split('/')\n          if (name[0] === '@' && segments.length > 1)\n            return segments.length > 1 ? segments.slice(0, 2).join('/') : null\n          return segments.length ? segments[0] : null\n        }\n\n        const getResolve = (options: any) => {\n          const curResolver = resolver.withOptions(options)\n\n          return (\n            parent: string,\n            request: string,\n            job: import('@vercel/nft/out/node-file-trace').Job\n          ) =>\n            new Promise<[string, boolean]>((resolve, reject) => {\n              const context = nodePath.dirname(parent)\n\n              curResolver.resolve(\n                {},\n                context,\n                request,\n                {\n                  fileDependencies: compilation.fileDependencies,\n                  missingDependencies: compilation.missingDependencies,\n                  contextDependencies: compilation.contextDependencies,\n                },\n                async (err: any, result?, resContext?) => {\n                  if (err) return reject(err)\n\n                  if (!result) {\n                    return reject(new Error('module not found'))\n                  }\n\n                  // webpack resolver doesn't strip loader query info\n                  // from the result so use path instead\n                  if (result.includes('?') || result.includes('!')) {\n                    result = resContext?.path || result\n                  }\n\n                  try {\n                    // we need to collect all parent package.json's used\n                    // as webpack's resolve doesn't expose this and parent\n                    // package.json could be needed for resolving e.g. stylis\n                    // stylis/package.json -> stylis/dist/umd/package.json\n                    if (result.includes('node_modules')) {\n                      let requestPath = result\n                        .replace(/\\\\/g, '/')\n                        .replace(/\\0/g, '')\n\n                      if (\n                        !nodePath.isAbsolute(request) &&\n                        request.includes('/') &&\n                        resContext?.descriptionFileRoot\n                      ) {\n                        requestPath = (\n                          resContext.descriptionFileRoot +\n                          request.substr(getPkgName(request)?.length || 0) +\n                          nodePath.sep +\n                          'package.json'\n                        )\n                          .replace(/\\\\/g, '/')\n                          .replace(/\\0/g, '')\n                      }\n\n                      const rootSeparatorIndex = requestPath.indexOf('/')\n                      let separatorIndex: number\n                      while (\n                        (separatorIndex = requestPath.lastIndexOf('/')) >\n                        rootSeparatorIndex\n                      ) {\n                        requestPath = requestPath.substr(0, separatorIndex)\n                        const curPackageJsonPath = `${requestPath}/package.json`\n                        if (await job.isFile(curPackageJsonPath)) {\n                          await job.emitFile(\n                            curPackageJsonPath,\n                            'resolve',\n                            parent\n                          )\n                        }\n                      }\n                    }\n                  } catch (_err) {\n                    // we failed to resolve the package.json boundary,\n                    // we don't block emitting the initial asset from this\n                  }\n                  resolve([result, options.dependencyType === 'esm'])\n                }\n              )\n            })\n        }\n\n        const CJS_RESOLVE_OPTIONS = {\n          ...NODE_RESOLVE_OPTIONS,\n          fullySpecified: undefined,\n          modules: undefined,\n          extensions: undefined,\n        }\n        const BASE_CJS_RESOLVE_OPTIONS = {\n          ...CJS_RESOLVE_OPTIONS,\n          alias: false,\n        }\n        const ESM_RESOLVE_OPTIONS = {\n          ...NODE_ESM_RESOLVE_OPTIONS,\n          fullySpecified: undefined,\n          modules: undefined,\n          extensions: undefined,\n        }\n        const BASE_ESM_RESOLVE_OPTIONS = {\n          ...ESM_RESOLVE_OPTIONS,\n          alias: false,\n        }\n\n        const doResolve = async (\n          request: string,\n          parent: string,\n          job: import('@vercel/nft/out/node-file-trace').Job,\n          isEsmRequested: boolean\n        ): Promise<string> => {\n          const context = nodePath.dirname(parent)\n          // When in esm externals mode, and using import, we resolve with\n          // ESM resolving options.\n          const { res } = await resolveExternal(\n            this.appDir,\n            this.esmExternals,\n            context,\n            request,\n            isEsmRequested,\n            (options) => (_: string, resRequest: string) => {\n              return getResolve(options)(parent, resRequest, job)\n            },\n            undefined,\n            undefined,\n            ESM_RESOLVE_OPTIONS,\n            CJS_RESOLVE_OPTIONS,\n            BASE_ESM_RESOLVE_OPTIONS,\n            BASE_CJS_RESOLVE_OPTIONS\n          )\n\n          if (!res) {\n            throw new Error(`failed to resolve ${request} from ${parent}`)\n          }\n          return res.replace(/\\0/g, '')\n        }\n\n        this.tapfinishModules(\n          compilation,\n          traceEntrypointsPluginSpan,\n          doResolve,\n          readlink,\n          stat\n        )\n      })\n    })\n  }\n}\n"],"names":["PLUGIN_NAME","TRACE_IGNORES","getModuleFromDependency","compilation","dep","moduleGraph","getModule","getFilesMapFromReasons","fileList","reasons","ignoreFn","parentFilesMap","Map","propagateToParents","parents","file","seen","Set","parent","has","add","parentFiles","get","set","parentReason","reason","type","size","TraceEntryPointsPlugin","appDir","excludeFiles","esmExternals","staticImageImports","outputFileTracingRoot","entryTraces","tracingRoot","createTraceAssets","assets","span","readlink","stat","outputPath","outputOptions","path","traceChild","traceAsyncFn","entryFilesMap","chunksToTrace","entrypoint","entrypoints","values","entryFiles","chunk","getEntrypointChunk","getAllReferencedChunks","files","filePath","join","auxiliaryFiles","result","base","processCwd","readFile","source","relative","replace","Promise","resolve","reject","inputFileSystem","err","data","e","code","ignore","mixedModules","esmFileList","forEach","traceOutputName","name","traceOutputPath","dirname","allEntryFiles","child","delete","RawSource","JSON","stringify","version","map","tapfinishModules","traceEntrypointsPluginSpan","doResolve","hooks","finishModules","tapAsync","_stats","callback","finishModulesSpan","entryNameMap","entryModMap","additionalEntries","depModMap","traceFn","entries","entry","startsWith","dependencies","entryMod","resource","includes","curMap","mod","originalSource","buffer","entryPaths","Array","from","keys","collectDependencies","depMod","entriesToTrace","entryName","curExtraEntries","push","traceEntryCount","length","id","job","isCjs","undefined","isArray","loaders","normalizedEntry","finalDeps","extraEntry","normalizedExtraEntry","then","apply","compiler","tap","link","stats","compilationSpan","processAssets","stage","Compilation","PROCESS_ASSETS_STAGE_SUMMARIZE","catch","resolver","resolverFactory","getPkgName","segments","split","slice","getResolve","options","curResolver","withOptions","request","context","fileDependencies","missingDependencies","contextDependencies","resContext","Error","requestPath","isAbsolute","descriptionFileRoot","substr","sep","rootSeparatorIndex","indexOf","separatorIndex","lastIndexOf","curPackageJsonPath","isFile","emitFile","_err","dependencyType","CJS_RESOLVE_OPTIONS","fullySpecified","modules","extensions","BASE_CJS_RESOLVE_OPTIONS","alias","ESM_RESOLVE_OPTIONS","BASE_ESM_RESOLVE_OPTIONS","isEsmRequested","res","_","resRequest"],"mappings":"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"}