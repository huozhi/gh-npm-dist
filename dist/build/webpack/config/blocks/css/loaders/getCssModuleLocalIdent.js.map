{"version":3,"sources":["../../../../../../../build/webpack/config/blocks/css/loaders/getCssModuleLocalIdent.ts"],"sourcesContent":["import loaderUtils from 'next/dist/compiled/loader-utils3'\nimport path from 'path'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\n\nconst regexLikeIndexModule = /(?<!pages[\\\\/])index\\.module\\.(scss|sass|css)$/\n\nexport function getCssModuleLocalIdent(\n  context: webpack.loader.LoaderContext,\n  _: any,\n  exportName: string,\n  options: object\n) {\n  const relativePath = path\n    .relative(context.rootContext, context.resourcePath)\n    .replace(/\\\\+/g, '/')\n\n  // Generate a more meaningful name (parent folder) when the user names the\n  // file `index.module.css`.\n  const fileNameOrFolder = regexLikeIndexModule.test(relativePath)\n    ? '[folder]'\n    : '[name]'\n\n  // Generate a hash to make the class name unique.\n  const hash = loaderUtils.getHashDigest(\n    Buffer.from(`filePath:${relativePath}#className:${exportName}`),\n    'md5',\n    'base64',\n    5\n  )\n\n  // Have webpack interpolate the `[folder]` or `[name]` to its real value.\n  return (\n    loaderUtils\n      .interpolateName(\n        context,\n        fileNameOrFolder + '_' + exportName + '__' + hash,\n        options\n      )\n      .replace(\n        // Webpack name interpolation returns `about.module_root__2oFM9` for\n        // `.root {}` inside a file named `about.module.css`. Let's simplify\n        // this.\n        /\\.module_/,\n        '_'\n      )\n      // Replace invalid symbols with underscores instead of escaping\n      // https://mathiasbynens.be/notes/css-escapes#identifiers-strings\n      .replace(/[^a-zA-Z0-9-_]/g, '_')\n      // \"they cannot start with a digit, two hyphens, or a hyphen followed by a digit [sic]\"\n      // https://www.w3.org/TR/CSS21/syndata.html#characters\n      .replace(/^(\\d|--|-\\d)/, '__$1')\n  )\n}\n"],"names":["getCssModuleLocalIdent","regexLikeIndexModule","context","_","exportName","options","relativePath","relative","rootContext","resourcePath","replace","fileNameOrFolder","test","hash","getHashDigest","Buffer","from","interpolateName"],"mappings":";;;;QAMgBA,sBAAsB,GAAtBA,sBAAsB;AANd,GAAkC,CAAlC,aAAkC;AACzC,GAAM,CAAN,KAAM;;;;;;AAGvB,KAAK,CAACC,oBAAoB;SAEVD,sBAAsB,CACpCE,OAAqC,EACrCC,CAAM,EACNC,UAAkB,EAClBC,OAAe,EACf,CAAC;IACD,KAAK,CAACC,YAAY,GAXH,KAAM,SAYlBC,QAAQ,CAACL,OAAO,CAACM,WAAW,EAAEN,OAAO,CAACO,YAAY,EAClDC,OAAO,SAAS,CAAG;IAEtB,EAA0E,AAA1E,wEAA0E;IAC1E,EAA2B,AAA3B,yBAA2B;IAC3B,KAAK,CAACC,gBAAgB,GAAGV,oBAAoB,CAACW,IAAI,CAACN,YAAY,IAC3D,CAAU,YACV,CAAQ;IAEZ,EAAiD,AAAjD,+CAAiD;IACjD,KAAK,CAACO,IAAI,GAvBY,aAAkC,SAuB/BC,aAAa,CACpCC,MAAM,CAACC,IAAI,EAAE,SAAS,EAAEV,YAAY,CAAC,WAAW,EAAEF,UAAU,KAC5D,CAAK,MACL,CAAQ,SACR,CAAC;IAGH,EAAyE,AAAzE,uEAAyE;IACzE,MAAM,CA/BgB,aAAkC,SAiCnDa,eAAe,CACdf,OAAO,EACPS,gBAAgB,GAAG,CAAG,KAAGP,UAAU,GAAG,CAAI,MAAGS,IAAI,EACjDR,OAAO,EAERK,OAAO,CACN,EAAoE,AAApE,kEAAoE;IACpE,EAAoE,AAApE,kEAAoE;IACpE,EAAQ,AAAR,MAAQ;iBAER,CAAG,GAEL,EAA+D,AAA/D,6DAA+D;IAC/D,EAAiE,AAAjE,+DAAiE;KAChEA,OAAO,oBAAoB,CAAG,GAC/B,EAAuF,AAAvF,qFAAuF;IACvF,EAAsD,AAAtD,oDAAsD;KACrDA,OAAO,iBAAiB,CAAM;AAErC,CAAC"}