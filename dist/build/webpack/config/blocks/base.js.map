{"version":3,"sources":["../../../../../build/webpack/config/blocks/base.ts"],"sourcesContent":["import curry from 'next/dist/compiled/lodash.curry'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\nimport { ConfigurationContext } from '../utils'\n\nexport const base = curry(function base(\n  ctx: ConfigurationContext,\n  config: webpack.Configuration\n) {\n  config.mode = ctx.isDevelopment ? 'development' : 'production'\n  config.name = ctx.isServer\n    ? ctx.webServerRuntime\n      ? 'server-web'\n      : 'server'\n    : 'client'\n\n  // @ts-ignore TODO webpack 5 typings\n  config.target = !ctx.targetWeb\n    ? 'node12.22'\n    : ctx.webServerRuntime\n    ? ['web', 'es6']\n    : ['web', 'es5']\n\n  // https://webpack.js.org/configuration/devtool/#development\n  if (ctx.isDevelopment) {\n    if (process.env.__NEXT_TEST_MODE && !process.env.__NEXT_TEST_WITH_DEVTOOL) {\n      config.devtool = false\n    } else {\n      if (!ctx.webServerRuntime) {\n        // `eval-source-map` provides full-fidelity source maps for the\n        // original source, including columns and original variable names.\n        // This is desirable so the in-browser debugger can correctly pause\n        // and show scoped variables with their original names.\n        config.devtool = 'eval-source-map'\n      }\n    }\n  } else {\n    // Enable browser sourcemaps:\n    if (ctx.productionBrowserSourceMaps && ctx.isClient) {\n      config.devtool = 'source-map'\n    } else {\n      config.devtool = false\n    }\n  }\n\n  if (!config.module) {\n    config.module = { rules: [] }\n  }\n\n  // TODO: add codemod for \"Should not import the named export\" with JSON files\n  // config.module.strictExportPresence = !isWebpack5\n\n  return config\n})\n"],"names":["base","ctx","config","mode","isDevelopment","name","isServer","webServerRuntime","target","targetWeb","process","env","__NEXT_TEST_MODE","__NEXT_TEST_WITH_DEVTOOL","devtool","productionBrowserSourceMaps","isClient","module","rules"],"mappings":";;;;;AAAkB,GAAiC,CAAjC,YAAiC;;;;;;AAI5C,KAAK,CAACA,IAAI,OAJC,YAAiC,UAIzB,QAAQ,CAACA,IAAI,CACrCC,GAAyB,EACzBC,MAA6B,EAC7B,CAAC;IACDA,MAAM,CAACC,IAAI,GAAGF,GAAG,CAACG,aAAa,GAAG,CAAa,eAAG,CAAY;IAC9DF,MAAM,CAACG,IAAI,GAAGJ,GAAG,CAACK,QAAQ,GACtBL,GAAG,CAACM,gBAAgB,GAClB,CAAY,cACZ,CAAQ,UACV,CAAQ;IAEZ,EAAoC,AAApC,kCAAoC;IACpCL,MAAM,CAACM,MAAM,IAAIP,GAAG,CAACQ,SAAS,GAC1B,CAAW,aACXR,GAAG,CAACM,gBAAgB,GACpB,CAAC;QAAA,CAAK;QAAE,CAAK;IAAA,CAAC,GACd,CAAC;QAAA,CAAK;QAAE,CAAK;IAAA,CAAC;IAElB,EAA4D,AAA5D,0DAA4D;IAC5D,EAAE,EAAEN,GAAG,CAACG,aAAa,EAAE,CAAC;QACtB,EAAE,EAAEM,OAAO,CAACC,GAAG,CAACC,gBAAgB,KAAKF,OAAO,CAACC,GAAG,CAACE,wBAAwB,EAAE,CAAC;YAC1EX,MAAM,CAACY,OAAO,GAAG,KAAK;QACxB,CAAC,MAAM,CAAC;YACN,EAAE,GAAGb,GAAG,CAACM,gBAAgB,EAAE,CAAC;gBAC1B,EAA+D,AAA/D,6DAA+D;gBAC/D,EAAkE,AAAlE,gEAAkE;gBAClE,EAAmE,AAAnE,iEAAmE;gBACnE,EAAuD,AAAvD,qDAAuD;gBACvDL,MAAM,CAACY,OAAO,GAAG,CAAiB;YACpC,CAAC;QACH,CAAC;IACH,CAAC,MAAM,CAAC;QACN,EAA6B,AAA7B,2BAA6B;QAC7B,EAAE,EAAEb,GAAG,CAACc,2BAA2B,IAAId,GAAG,CAACe,QAAQ,EAAE,CAAC;YACpDd,MAAM,CAACY,OAAO,GAAG,CAAY;QAC/B,CAAC,MAAM,CAAC;YACNZ,MAAM,CAACY,OAAO,GAAG,KAAK;QACxB,CAAC;IACH,CAAC;IAED,EAAE,GAAGZ,MAAM,CAACe,MAAM,EAAE,CAAC;QACnBf,MAAM,CAACe,MAAM,GAAG,CAAC;YAACC,KAAK,EAAE,CAAC,CAAC;QAAC,CAAC;IAC/B,CAAC;IAED,EAA6E,AAA7E,2EAA6E;IAC7E,EAAmD,AAAnD,iDAAmD;IAEnD,MAAM,CAAChB,MAAM;AACf,CAAC;QAhDYF,IAAI,GAAJA,IAAI"}