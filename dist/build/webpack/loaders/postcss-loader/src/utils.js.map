{"version":3,"sources":["../../../../../../build/webpack/loaders/postcss-loader/src/utils.js"],"sourcesContent":["import path from 'path'\n\nconst IS_NATIVE_WIN32_PATH = /^[a-z]:[/\\\\]|^\\\\\\\\/i\nconst ABSOLUTE_SCHEME = /^[a-z0-9+\\-.]+:/i\n\nfunction getURLType(source) {\n  if (source[0] === '/') {\n    if (source[1] === '/') {\n      return 'scheme-relative'\n    }\n\n    return 'path-absolute'\n  }\n\n  if (IS_NATIVE_WIN32_PATH.test(source)) {\n    return 'path-absolute'\n  }\n\n  return ABSOLUTE_SCHEME.test(source) ? 'absolute' : 'path-relative'\n}\n\nfunction normalizeSourceMap(map, resourceContext) {\n  let newMap = map\n\n  // Some loader emit source map as string\n  // Strip any JSON XSSI avoidance prefix from the string (as documented in the source maps specification), and then parse the string as JSON.\n  if (typeof newMap === 'string') {\n    newMap = JSON.parse(newMap)\n  }\n\n  delete newMap.file\n\n  const { sourceRoot } = newMap\n\n  delete newMap.sourceRoot\n\n  if (newMap.sources) {\n    newMap.sources = newMap.sources.map((source) => {\n      const sourceType = getURLType(source)\n\n      // Do no touch `scheme-relative` and `absolute` URLs\n      if (sourceType === 'path-relative' || sourceType === 'path-absolute') {\n        const absoluteSource =\n          sourceType === 'path-relative' && sourceRoot\n            ? path.resolve(sourceRoot, path.normalize(source))\n            : path.normalize(source)\n\n        return path.relative(resourceContext, absoluteSource)\n      }\n\n      return source\n    })\n  }\n\n  return newMap\n}\n\nfunction normalizeSourceMapAfterPostcss(map, resourceContext) {\n  const newMap = map\n\n  // result.map.file is an optional property that provides the output filename.\n  // Since we don't know the final filename in the webpack build chain yet, it makes no sense to have it.\n  // eslint-disable-next-line no-param-reassign\n  delete newMap.file\n\n  // eslint-disable-next-line no-param-reassign\n  newMap.sourceRoot = ''\n\n  // eslint-disable-next-line no-param-reassign\n  newMap.sources = newMap.sources.map((source) => {\n    if (source.indexOf('<') === 0) {\n      return source\n    }\n\n    const sourceType = getURLType(source)\n\n    // Do no touch `scheme-relative`, `path-absolute` and `absolute` types\n    if (sourceType === 'path-relative') {\n      return path.resolve(resourceContext, source)\n    }\n\n    return source\n  })\n\n  return newMap\n}\n\nexport { normalizeSourceMap, normalizeSourceMapAfterPostcss }\n"],"names":["IS_NATIVE_WIN32_PATH","ABSOLUTE_SCHEME","getURLType","source","test","normalizeSourceMap","map","resourceContext","newMap","JSON","parse","file","sourceRoot","sources","sourceType","absoluteSource","resolve","normalize","relative","normalizeSourceMapAfterPostcss","indexOf"],"mappings":";;;;;AAAiB,GAAM,CAAN,KAAM;;;;;;AAEvB,KAAK,CAACA,oBAAoB;AAC1B,KAAK,CAACC,eAAe;SAEZC,UAAU,CAACC,MAAM,EAAE,CAAC;IAC3B,EAAE,EAAEA,MAAM,CAAC,CAAC,MAAM,CAAG,IAAE,CAAC;QACtB,EAAE,EAAEA,MAAM,CAAC,CAAC,MAAM,CAAG,IAAE,CAAC;YACtB,MAAM,CAAC,CAAiB;QAC1B,CAAC;QAED,MAAM,CAAC,CAAe;IACxB,CAAC;IAED,EAAE,EAAEH,oBAAoB,CAACI,IAAI,CAACD,MAAM,GAAG,CAAC;QACtC,MAAM,CAAC,CAAe;IACxB,CAAC;IAED,MAAM,CAACF,eAAe,CAACG,IAAI,CAACD,MAAM,IAAI,CAAU,YAAG,CAAe;AACpE,CAAC;SAEQE,kBAAkB,CAACC,GAAG,EAAEC,eAAe,EAAE,CAAC;IACjD,GAAG,CAACC,MAAM,GAAGF,GAAG;IAEhB,EAAwC,AAAxC,sCAAwC;IACxC,EAA4I,AAA5I,0IAA4I;IAC5I,EAAE,EAAE,MAAM,CAACE,MAAM,KAAK,CAAQ,SAAE,CAAC;QAC/BA,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACF,MAAM;IAC5B,CAAC;IAED,MAAM,CAACA,MAAM,CAACG,IAAI;IAElB,KAAK,CAAC,CAAC,CAACC,UAAU,EAAC,CAAC,GAAGJ,MAAM;IAE7B,MAAM,CAACA,MAAM,CAACI,UAAU;IAExB,EAAE,EAAEJ,MAAM,CAACK,OAAO,EAAE,CAAC;QACnBL,MAAM,CAACK,OAAO,GAAGL,MAAM,CAACK,OAAO,CAACP,GAAG,EAAEH,MAAM,GAAK,CAAC;YAC/C,KAAK,CAACW,UAAU,GAAGZ,UAAU,CAACC,MAAM;YAEpC,EAAoD,AAApD,kDAAoD;YACpD,EAAE,EAAEW,UAAU,KAAK,CAAe,kBAAIA,UAAU,KAAK,CAAe,gBAAE,CAAC;gBACrE,KAAK,CAACC,cAAc,GAClBD,UAAU,KAAK,CAAe,kBAAIF,UAAU,GA3CrC,KAAM,SA4CJI,OAAO,CAACJ,UAAU,EA5CpB,KAAM,SA4CqBK,SAAS,CAACd,MAAM,KA5C3C,KAAM,SA6CJc,SAAS,CAACd,MAAM;gBAE3B,MAAM,CA/CG,KAAM,SA+CHe,QAAQ,CAACX,eAAe,EAAEQ,cAAc;YACtD,CAAC;YAED,MAAM,CAACZ,MAAM;QACf,CAAC;IACH,CAAC;IAED,MAAM,CAACK,MAAM;AACf,CAAC;SAEQW,8BAA8B,CAACb,GAAG,EAAEC,eAAe,EAAE,CAAC;IAC7D,KAAK,CAACC,MAAM,GAAGF,GAAG;IAElB,EAA6E,AAA7E,2EAA6E;IAC7E,EAAuG,AAAvG,qGAAuG;IACvG,EAA6C,AAA7C,2CAA6C;IAC7C,MAAM,CAACE,MAAM,CAACG,IAAI;IAElB,EAA6C,AAA7C,2CAA6C;IAC7CH,MAAM,CAACI,UAAU,GAAG,CAAE;IAEtB,EAA6C,AAA7C,2CAA6C;IAC7CJ,MAAM,CAACK,OAAO,GAAGL,MAAM,CAACK,OAAO,CAACP,GAAG,EAAEH,MAAM,GAAK,CAAC;QAC/C,EAAE,EAAEA,MAAM,CAACiB,OAAO,CAAC,CAAG,QAAM,CAAC,EAAE,CAAC;YAC9B,MAAM,CAACjB,MAAM;QACf,CAAC;QAED,KAAK,CAACW,UAAU,GAAGZ,UAAU,CAACC,MAAM;QAEpC,EAAsE,AAAtE,oEAAsE;QACtE,EAAE,EAAEW,UAAU,KAAK,CAAe,gBAAE,CAAC;YACnC,MAAM,CA9EK,KAAM,SA8ELE,OAAO,CAACT,eAAe,EAAEJ,MAAM;QAC7C,CAAC;QAED,MAAM,CAACA,MAAM;IACf,CAAC;IAED,MAAM,CAACK,MAAM;AACf,CAAC;QAEQH,kBAAkB,GAAlBA,kBAAkB;QAAEc,8BAA8B,GAA9BA,8BAA8B"}